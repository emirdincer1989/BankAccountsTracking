<!doctype html>
<html lang="en" data-layout="vertical" data-topbar="light" data-sidebar="dark" data-sidebar-size="lg" data-sidebar-image="none" data-preloader="disable">

<head>
    <meta charset="utf-8" />
    <title>Bor√ß Takip Sistemi</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="Bor√ß Takip ve Y√∂netim Sistemi" name="description" />
    <meta content="Bor√ß Takip Sistemi" name="author" />
    
    <!-- App favicon -->
    <link rel="shortcut icon" href="assets/images/favicon.ico">

    <!-- Layout config Js -->
    <script src="assets/js/layout.js"></script>
    <!-- Bootstrap Css -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <!-- Icons Css -->
    <link href="assets/css/icons.min.css" rel="stylesheet" type="text/css" />
    <!-- App Css-->
    <link href="assets/css/app.min.css" rel="stylesheet" type="text/css" />
    <!-- custom Css-->
    <link href="assets/css/custom.min.css" rel="stylesheet" type="text/css" />
</head>

<body>
    <!-- Begin page -->
    <div id="layout-wrapper">
        <!-- Header -->
        <header id="page-topbar">
    <div class="layout-width">
        <div class="navbar-header">
            <div class="d-flex">
                <!-- LOGO -->
                <div class="navbar-brand-box horizontal-logo">
                    <a href="/dashboard" class="logo logo-dark">
                        <span class="logo-sm">
                            <img src="assets/images/logo-sm.png" alt="" height="22">
                        </span>
                        <span class="logo-lg">
                            <img src="assets/images/logo-dark.png" alt="" height="17">
                        </span>
                    </a>

                    <a href="/dashboard" class="logo logo-light">
                        <span class="logo-sm">
                            <img src="assets/images/logo-sm.png" alt="" height="22">
                        </span>
                        <span class="logo-lg">
                            <img src="assets/images/logo-light.png" alt="" height="17">
                        </span>
                    </a>
                </div>

                <button type="button" class="btn btn-sm px-3 fs-16 header-item vertical-menu-btn topnav-hamburger" id="topnav-hamburger-icon">
                    <span class="hamburger-icon">
                        <span></span>
                        <span></span>
                        <span></span>
                    </span>
                </button>

                <!-- App Search-->
                <form class="app-search d-none d-md-block">
                    <div class="position-relative">
                        <input type="text" class="form-control" placeholder="Search..." autocomplete="off" id="search-options" value="">
                        <span class="mdi mdi-magnify search-widget-icon"></span>
                        <span class="mdi mdi-close-circle search-widget-icon search-widget-icon-close d-none" id="search-close-options"></span>
                    </div>
                    <div class="dropdown-menu dropdown-menu-lg" id="search-dropdown">
                        <div data-simplebar style="max-height: 320px;">
                            <!-- item-->
                            <div class="dropdown-header">
                                <h6 class="text-overflow text-muted mb-0 text-uppercase">Recent Searches</h6>
                            </div>

                            <div class="dropdown-item bg-transparent text-wrap">
                                <a href="index.html" class="btn btn-soft-secondary btn-sm rounded-pill">how to setup <i class="mdi mdi-magnify ms-1"></i></a>
                                <a href="index.html" class="btn btn-soft-secondary btn-sm rounded-pill">buttons <i class="mdi mdi-magnify ms-1"></i></a>
                            </div>
                            <!-- item-->
                            <div class="dropdown-header mt-2">
                                <h6 class="text-overflow text-muted mb-1 text-uppercase">Pages</h6>
                            </div>

                            <!-- item-->
                            <a href="javascript:void(0);" class="dropdown-item notify-item">
                                <i class="ri-bubble-chart-line align-middle fs-18 text-muted me-2"></i>
                                <span>Analytics Dashboard</span>
                            </a>

                            <!-- item-->
                            <a href="javascript:void(0);" class="dropdown-item notify-item">
                                <i class="ri-lifebuoy-line align-middle fs-18 text-muted me-2"></i>
                                <span>Help Center</span>
                            </a>

                            <!-- item-->
                            <a href="javascript:void(0);" class="dropdown-item notify-item">
                                <i class="ri-user-settings-line align-middle fs-18 text-muted me-2"></i>
                                <span>My account settings</span>
                            </a>

                            <!-- item-->
                            <div class="dropdown-header mt-2">
                                <h6 class="text-overflow text-muted mb-2 text-uppercase">Members</h6>
                            </div>

                            <div class="notification-list">
                                <!-- item -->
                                <a href="javascript:void(0);" class="dropdown-item notify-item py-2">
                                    <div class="d-flex">
                                        <img src="assets/images/users/avatar-2.jpg" class="me-3 rounded-circle avatar-xs" alt="user-pic">
                                        <div class="flex-grow-1">
                                            <h6 class="m-0">Angela Bernier</h6>
                                            <span class="fs-11 mb-0 text-muted">Manager</span>
                                        </div>
                                    </div>
                                </a>
                                <!-- item -->
                                <a href="javascript:void(0);" class="dropdown-item notify-item py-2">
                                    <div class="d-flex">
                                        <img src="assets/images/users/avatar-3.jpg" class="me-3 rounded-circle avatar-xs" alt="user-pic">
                                        <div class="flex-grow-1">
                                            <h6 class="m-0">David Grasso</h6>
                                            <span class="fs-11 mb-0 text-muted">Web Designer</span>
                                        </div>
                                    </div>
                                </a>
                                <!-- item -->
                                <a href="javascript:void(0);" class="dropdown-item notify-item py-2">
                                    <div class="d-flex">
                                        <img src="assets/images/users/avatar-5.jpg" class="me-3 rounded-circle avatar-xs" alt="user-pic">
                                        <div class="flex-grow-1">
                                            <h6 class="m-0">Mike Bunch</h6>
                                            <span class="fs-11 mb-0 text-muted">React Developer</span>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        </div>

                        <div class="text-center pt-3 pb-1">
                            <a href="pages-search-results.html" class="btn btn-primary btn-sm">View All Results <i class="ri-arrow-right-line ms-1"></i></a>
                        </div>
                    </div>
                </form>
            </div>

            <div class="d-flex align-items-center">

                <div class="dropdown d-md-none topbar-head-dropdown header-item">
                    <button type="button" class="btn btn-icon btn-topbar btn-ghost-secondary rounded-circle" id="page-header-search-dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="bx bx-search fs-22"></i>
                    </button>
                    <div class="dropdown-menu dropdown-menu-lg dropdown-menu-end p-0" aria-labelledby="page-header-search-dropdown">
                        <form class="p-3">
                            <div class="form-group m-0">
                                <div class="input-group">
                                    <input type="text" class="form-control" placeholder="Search ..." aria-label="Recipient's username">
                                    <button class="btn btn-primary" type="submit"><i class="mdi mdi-magnify"></i></button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="dropdown ms-1 topbar-head-dropdown header-item">
                    <button type="button" class="btn btn-icon btn-topbar btn-ghost-secondary rounded-circle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <img id="header-lang-img" src="assets/images/flags/us.svg" alt="Header Language" height="20" class="rounded">
                    </button>
                    <div class="dropdown-menu dropdown-menu-end">

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item language py-2" data-lang="en" title="English">
                            <img src="assets/images/flags/us.svg" alt="user-image" class="me-2 rounded" height="18">
                            <span class="align-middle">English</span>
                        </a>

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item language" data-lang="sp" title="Spanish">
                            <img src="assets/images/flags/spain.svg" alt="user-image" class="me-2 rounded" height="18">
                            <span class="align-middle">Espa√±ola</span>
                        </a>

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item language" data-lang="gr" title="German">
                            <img src="assets/images/flags/germany.svg" alt="user-image" class="me-2 rounded" height="18"> <span class="align-middle">Deutsche</span>
                        </a>

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item language" data-lang="it" title="Italian">
                            <img src="assets/images/flags/italy.svg" alt="user-image" class="me-2 rounded" height="18">
                            <span class="align-middle">Italiana</span>
                        </a>

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item language" data-lang="ru" title="Russian">
                            <img src="assets/images/flags/russia.svg" alt="user-image" class="me-2 rounded" height="18">
                            <span class="align-middle">—Ä—É—Å—Å–∫–∏–π</span>
                        </a>

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item language" data-lang="ch" title="Chinese">
                            <img src="assets/images/flags/china.svg" alt="user-image" class="me-2 rounded" height="18">
                            <span class="align-middle">‰∏≠ÂõΩ‰∫∫</span>
                        </a>

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item language" data-lang="fr" title="French">
                            <img src="assets/images/flags/french.svg" alt="user-image" class="me-2 rounded" height="18">
                            <span class="align-middle">fran√ßais</span>
                        </a>

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item language" data-lang="ar" title="Arabic">
                            <img src="assets/images/flags/ae.svg" alt="user-image" class="me-2 rounded" height="18">
                            <span class="align-middle">Arabic</span>
                        </a>
                    </div>
                </div>

                <div class="dropdown topbar-head-dropdown ms-1 header-item">
                    <button type="button" class="btn btn-icon btn-topbar btn-ghost-secondary rounded-circle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class='bx bx-category-alt fs-22'></i>
                    </button>
                    <div class="dropdown-menu dropdown-menu-lg p-0 dropdown-menu-end">
                        <div class="p-3 border-top-0 border-start-0 border-end-0 border-dashed border">
                            <div class="row align-items-center">
                                <div class="col">
                                    <h6 class="m-0 fw-semibold fs-15"> Web Apps </h6>
                                </div>
                                <div class="col-auto">
                                    <a href="#!" class="btn btn-sm btn-soft-info"> View All Apps
                                        <i class="ri-arrow-right-s-line align-middle"></i></a>
                                </div>
                            </div>
                        </div>

                        <div class="p-2">
                            <div class="row g-0">
                                <div class="col">
                                    <a class="dropdown-icon-item" href="#!">
                                        <img src="assets/images/brands/github.png" alt="Github">
                                        <span>GitHub</span>
                                    </a>
                                </div>
                                <div class="col">
                                    <a class="dropdown-icon-item" href="#!">
                                        <img src="assets/images/brands/bitbucket.png" alt="bitbucket">
                                        <span>Bitbucket</span>
                                    </a>
                                </div>
                                <div class="col">
                                    <a class="dropdown-icon-item" href="#!">
                                        <img src="assets/images/brands/dribbble.png" alt="dribbble">
                                        <span>Dribbble</span>
                                    </a>
                                </div>
                            </div>

                            <div class="row g-0">
                                <div class="col">
                                    <a class="dropdown-icon-item" href="#!">
                                        <img src="assets/images/brands/dropbox.png" alt="dropbox">
                                        <span>Dropbox</span>
                                    </a>
                                </div>
                                <div class="col">
                                    <a class="dropdown-icon-item" href="#!">
                                        <img src="assets/images/brands/mail_chimp.png" alt="mail_chimp">
                                        <span>Mail Chimp</span>
                                    </a>
                                </div>
                                <div class="col">
                                    <a class="dropdown-icon-item" href="#!">
                                        <img src="assets/images/brands/slack.png" alt="slack">
                                        <span>Slack</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="dropdown topbar-head-dropdown ms-1 header-item">
                    <button type="button" class="btn btn-icon btn-topbar btn-ghost-secondary rounded-circle" id="page-header-cart-dropdown" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-haspopup="true" aria-expanded="false">
                        <i class='bx bx-shopping-bag fs-22'></i>
                        <span class="position-absolute topbar-badge cartitem-badge fs-10 translate-middle badge rounded-pill bg-info">5</span>
                    </button>
                    <div class="dropdown-menu dropdown-menu-xl dropdown-menu-end p-0 dropdown-menu-cart" aria-labelledby="page-header-cart-dropdown">
                        <div class="p-3 border-top-0 border-start-0 border-end-0 border-dashed border">
                            <div class="row align-items-center">
                                <div class="col">
                                    <h6 class="m-0 fs-16 fw-semibold"> My Cart</h6>
                                </div>
                                <div class="col-auto">
                                    <span class="badge bg-info-subtle text-info fs-13"> 5 items</span>
                                </div>
                            </div>
                        </div>
                        <div data-simplebar style="max-height: 300px;">
                            <div class="p-2">
                                <div class="text-center py-3">
                                    <div class="avatar-md mx-auto mb-4">
                                        <div class="avatar-title bg-info-subtle text-info rounded-circle fs-36">
                                            <i class='bx bx-shopping-bag'></i>
                                        </div>
                                    </div>
                                    <h5>Your Cart is Empty!</h5>
                                    <p class="text-muted fs-15 mb-0">Add some items to your cart to continue.</p>
                                </div>
                            </div>
                        </div>
                        <div class="p-3 border-top-0 border-start-0 border-end-0 border-dashed border d-grid">
                            <div class="d-flex justify-content-between align-items-center pb-3">
                                <h5 class="m-0 text-muted">Total:</h5>
                                <div class="px-2">
                                    <h5 class="m-0">$1258.58</h5>
                                </div>
                            </div>

                            <a href="ecommerce-checkout.html" class="btn btn-success text-decoration-none">Checkout</a>
                        </div>
                    </div>
                </div>

                <div class="ms-1 header-item d-none d-sm-flex">
                    <button type="button" class="btn btn-icon btn-topbar btn-ghost-secondary rounded-circle" data-toggle="fullscreen">
                        <i class='bx bx-fullscreen fs-22'></i>
                    </button>
                </div>

                <div class="ms-1 header-item d-none d-sm-flex">
                    <button type="button" class="btn btn-icon btn-topbar btn-ghost-secondary rounded-circle light-dark-mode">
                        <i class='bx bx-moon fs-22'></i>
                    </button>
                </div>

                <div class="dropdown ms-1 topbar-head-dropdown header-item">
                    <button type="button" class="btn btn-icon btn-topbar btn-ghost-secondary rounded-circle" id="page-header-notifications-dropdown" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-haspopup="true" aria-expanded="false">
                        <i class='bx bx-bell fs-22'></i>
                        <span class="position-absolute topbar-badge fs-10 translate-middle badge rounded-pill bg-danger">3<span class="visually-hidden">unread messages</span></span>
                    </button>
                    <div class="dropdown-menu dropdown-menu-lg dropdown-menu-end p-0" aria-labelledby="page-header-notifications-dropdown">
                        <div class="dropdown-head bg-primary bg-pattern rounded-top">
                            <div class="p-3">
                                <div class="row align-items-center">
                                    <div class="col">
                                        <h6 class="m-0 fs-16 fw-semibold text-white"> Notifications </h6>
                                    </div>
                                    <div class="col-auto dropdown-tabs">
                                        <span class="badge bg-light-subtle text-body fs-13"> 4 New</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="tab-content position-relative" id="notificationItemsTab">
                            <div class="tab-pane fade show active py-2 ps-2" id="all-noti-tab" role="tabpanel">
                                <div data-simplebar style="max-height: 300px;" class="pe-2">
                                    <div class="text-reset notification-item d-block dropdown-item position-relative">
                                        <div class="d-flex">
                                            <div class="avatar-xs me-3">
                                                <span class="avatar-title bg-info-subtle text-info rounded-circle fs-16">
                                                    <i class="bx bx-badge-check"></i>
                                                </span>
                                            </div>
                                            <div class="flex-1">
                                                <a href="#!" class="stretched-link">
                                                    <h6 class="mt-0 mb-2 lh-base">Your <b>Elite</b> author Graphic Optimization <span class="text-secondary">reward</span> is ready!</h6>
                                                </a>
                                                <p class="mb-0 fs-11 fw-medium text-uppercase text-muted">
                                                    <span><i class="mdi mdi-clock-outline"></i> Just 30 sec ago</span>
                                                </p>
                                            </div>
                                            <div class="px-2 fs-15">
                                                <div class="form-check notification-check">
                                                    <input class="form-check-input" type="checkbox" value="" id="all-notification-check01">
                                                    <label class="form-check-label" for="all-notification-check01"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="text-reset notification-item d-block dropdown-item position-relative">
                                        <div class="d-flex">
                                            <img src="assets/images/users/avatar-2.jpg" class="me-3 rounded-circle avatar-xs" alt="user-pic">
                                            <div class="flex-1">
                                                <a href="#!" class="stretched-link">
                                                    <h6 class="mt-0 mb-1 fs-13 fw-semibold">Angela Bernier</h6>
                                                </a>
                                                <div class="fs-13 text-muted">
                                                    <p class="mb-1">Answered to your comment on the cash flow forecast's graph üîî.</p>
                                                </div>
                                                <p class="mb-0 fs-11 fw-medium text-uppercase text-muted">
                                                    <span><i class="mdi mdi-clock-outline"></i> 48 min ago</span>
                                                </p>
                                            </div>
                                            <div class="px-2 fs-15">
                                                <div class="form-check notification-check">
                                                    <input class="form-check-input" type="checkbox" value="" id="all-notification-check02">
                                                    <label class="form-check-label" for="all-notification-check02"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="text-reset notification-item d-block dropdown-item position-relative">
                                        <div class="d-flex">
                                            <div class="avatar-xs me-3">
                                                <span class="avatar-title bg-danger-subtle text-danger rounded-circle fs-16">
                                                    <i class='bx bx-message-square-detail'></i>
                                                </span>
                                            </div>
                                            <div class="flex-1">
                                                <a href="#!" class="stretched-link">
                                                    <h6 class="mt-0 mb-2 lh-base">You have received <b class="text-warning">21</b> new messages in your inbox</h6>
                                                </a>
                                                <p class="mb-0 fs-11 fw-medium text-uppercase text-muted">
                                                    <span><i class="mdi mdi-clock-outline"></i> 2 hours ago</span>
                                                </p>
                                            </div>
                                            <div class="px-2 fs-15">
                                                <div class="form-check notification-check">
                                                    <input class="form-check-input" type="checkbox" value="" id="all-notification-check03">
                                                    <label class="form-check-label" for="all-notification-check03"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane fade py-2 ps-2" id="messages-tab" role="tabpanel" aria-labelledby="messages-tab">
                                <div data-simplebar style="max-height: 300px;" class="pe-2">
                                    <div class="text-reset notification-item d-block dropdown-item">
                                        <div class="d-flex">
                                            <img src="assets/images/users/avatar-3.jpg" class="me-3 rounded-circle avatar-xs" alt="user-pic">
                                            <div class="flex-1">
                                                <a href="#!" class="stretched-link">
                                                    <h6 class="mt-0 mb-1 fs-13 fw-semibold">James Lemire</h6>
                                                </a>
                                                <div class="fs-13 text-muted">
                                                    <p class="mb-1">We talked about a project on linkedin.</p>
                                                </div>
                                                <p class="mb-0 fs-11 fw-medium text-uppercase text-muted">
                                                    <span><i class="mdi mdi-clock-outline"></i> 1 hour ago</span>
                                                </p>
                                            </div>
                                            <div class="px-2 fs-15">
                                                <div class="form-check notification-check">
                                                    <input class="form-check-input" type="checkbox" value="" id="messages-notification-check01">
                                                    <label class="form-check-label" for="messages-notification-check01"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="text-reset notification-item d-block dropdown-item">
                                        <div class="d-flex">
                                            <img src="assets/images/users/avatar-2.jpg" class="me-3 rounded-circle avatar-xs" alt="user-pic">
                                            <div class="flex-1">
                                                <a href="#!" class="stretched-link">
                                                    <h6 class="mt-0 mb-1 fs-13 fw-semibold">Angela Bernier</h6>
                                                </a>
                                                <div class="fs-13 text-muted">
                                                    <p class="mb-1">Answered to your comment on the cash flow forecast's graph üîî.</p>
                                                </div>
                                                <p class="mb-0 fs-11 fw-medium text-uppercase text-muted">
                                                    <span><i class="mdi mdi-clock-outline"></i> 2 hour ago</span>
                                                </p>
                                            </div>
                                            <div class="px-2 fs-15">
                                                <div class="form-check notification-check">
                                                    <input class="form-check-input" type="checkbox" value="" id="messages-notification-check02">
                                                    <label class="form-check-label" for="messages-notification-check02"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane fade p-4" id="alerts-tab" role="tabpanel" aria-labelledby="alerts-tab"></div>

                            <div class="notification-actions" id="notification-actions">
                                <div class="d-flex text-muted justify-content-center">
                                    Select <div id="select-content" class="text-body fw-semibold px-1">0</div> Result <button type="button" class="btn btn-link link-danger p-0 ms-3" data-bs-toggle="modal" data-bs-target="#removeNotificationModal">Remove</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="dropdown ms-sm-3 header-item topbar-user">
                    <button type="button" class="btn" id="page-header-user-dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="d-flex align-items-center">
                            <img class="rounded-circle header-profile-user" src="assets/images/users/avatar-1.jpg" alt="Header Avatar">
                            <span class="text-start ms-xl-2">
                                <span class="d-none d-xl-inline-block ms-1 fw-medium user-name-text" id="userName">Y√ºkleniyor...</span>
                                <span class="d-none d-xl-block ms-1 fs-12 user-name-sub-text" id="userRole">Y√ºkleniyor...</span>
                            </span>
                        </span>
                    </button>
                    <div class="dropdown-menu dropdown-menu-end">
                        <!-- item-->
                        <h6 class="dropdown-header">Ho≈ü Geldiniz!</h6>
                        <a class="dropdown-item" href="pages-profile.html"><i class="mdi mdi-account-circle text-muted fs-16 align-middle me-1"></i> <span class="align-middle">Profile</span></a>
                        <a class="dropdown-item" href="apps-chat.html"><i class="mdi mdi-message-text-outline text-muted fs-16 align-middle me-1"></i> <span class="align-middle">Messages</span></a>
                        <a class="dropdown-item" href="apps-tasks-kanban.html"><i class="mdi mdi-calendar-check-outline text-muted fs-16 align-middle me-1"></i> <span class="align-middle">Taskboard</span></a>
                        <a class="dropdown-item" href="pages-faqs.html"><i class="mdi mdi-lifebuoy text-muted fs-16 align-middle me-1"></i> <span class="align-middle">Help</span></a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="pages-profile.html"><i class="mdi mdi-wallet text-muted fs-16 align-middle me-1"></i> <span class="align-middle">Balance : <b>$5971.67</b></span></a>
                        <a class="dropdown-item" href="pages-profile-settings.html"><span class="badge bg-success-subtle text-success mt-1 float-end">New</span><i class="mdi mdi-cog-outline text-muted fs-16 align-middle me-1"></i> <span class="align-middle">Settings</span></a>
                        <a class="dropdown-item" href="auth-lockscreen-basic.html"><i class="mdi mdi-lock text-muted fs-16 align-middle me-1"></i> <span class="align-middle">Lock screen</span></a>
                        <a class="dropdown-item" href="javascript:void(0);" data-logout><i class="mdi mdi-logout text-muted fs-16 align-middle me-1"></i> <span class="align-middle" data-key="t-logout">Logout</span></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

        <!-- ========== App Menu ========== -->
        <div class="app-menu navbar-menu">
            <!-- LOGO -->
            <div class="navbar-brand-box">
                <!-- Dark Logo-->
                <a href="/dashboard" class="logo logo-dark">
                    <span class="logo-sm">
                        <img src="assets/images/logo-sm.png" alt="" height="22">
                    </span>
                    <span class="logo-lg">
                        <img src="assets/images/logo-dark.png" alt="" height="17">
                    </span>
                </a>
                <!-- Light Logo-->
                <a href="/dashboard" class="logo logo-light">
                    <span class="logo-sm">
                        <img src="assets/images/logo-sm.png" alt="" height="22">
                    </span>
                    <span class="logo-lg">
                        <img src="assets/images/logo-light.png" alt="" height="17">
                    </span>
                </a>
                <button type="button" class="btn btn-sm p-0 fs-20 header-item float-end btn-vertical-sm-hover" id="vertical-hover">
                    <i class="ri-record-circle-line"></i>
                </button>
            </div>

            <div id="scrollbar">
                <div class="container-fluid">

                    <div id="two-column-menu">
                    </div>
                    <ul class="navbar-nav" id="navbar-nav" style="display: none;">
                        <li class="menu-title"><span data-key="t-menu">Menu</span></li>
                        <li class="menu-title"><span data-key="t-dashboard">Dashboard</span></li>
                        <li class="nav-item">
                            <a class="nav-link menu-link" href="/dashboard">
                                <i class="ri-dashboard-2-line"></i> <span data-key="t-dashboard">Dashboard</span>
                            </a>
                        </li>
                        <li class="menu-title"><span data-key="t-admin-operations">Admin ƒ∞≈ülemleri</span></li>
                        <li class="nav-item">
                            <a class="nav-link menu-link" href="/users">
                                <i class="ri-user-settings-line"></i> <span data-key="t-user-management">Kullanƒ±cƒ± Y√∂netimi</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link menu-link" href="/roles">
                                <i class="ri-shield-user-line"></i> <span data-key="t-role-management">Rol Y√∂netimi</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link menu-link" href="/menus">
                                <i class="ri-menu-line"></i> <span data-key="t-menu-management">Men√º Y√∂netimi</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="sidebar-background"></div>
        </div>
        <div class="vertical-overlay"></div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="page-content">
                <div class="container-fluid">
                    <!-- Page Title -->
                    <div class="row">
                        <div class="col-12">
                            <div class="page-title-box d-sm-flex align-items-center justify-content-between">
                                <h4 class="mb-sm-0" id="pageTitle">Dashboard</h4>
                                <div class="page-title-right">
                                    <ol class="breadcrumb m-0">
                                        <li class="breadcrumb-item"><a href="javascript: void(0);">Bor√ß Takip</a></li>
                                        <li class="breadcrumb-item active" id="breadcrumbActive">Dashboard</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Dynamic Content Area -->
                    <div id="dynamicContent">
                        <!-- ƒ∞√ßerik buraya y√ºklenecek -->
                    </div>
                </div>
            </div>

            <footer class="footer">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-sm-6">
                            <script>document.write(new Date().getFullYear())</script> ¬© Velzon.
                        </div>
                        <div class="col-sm-6">
                            <div class="text-sm-end d-none d-sm-block">
                                Design & Develop by Themesbrand
                            </div>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
    </div>

    <!-- Kullanƒ±cƒ± Ekleme/D√ºzenleme Modal -->
    <div class="modal fade" id="userModal" tabindex="-1" aria-labelledby="userModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="userModalLabel">Yeni Kullanƒ±cƒ±</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="userForm">
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="userName" class="form-label">Ad Soyad <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="userName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="userEmail" class="form-label">E-posta <span class="text-danger">*</span></label>
                                    <input type="email" class="form-control" id="userEmail" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="userPassword" class="form-label">≈ûifre <span class="text-danger">*</span></label>
                                    <input type="password" class="form-control" id="userPassword" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="newUserRole" class="form-label">Rol <span class="text-danger">*</span></label>
                                    <select class="form-select" id="newUserRole" required>
                                        <option value="">Rol se√ßin</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row" id="userStatusRow" style="display: none;">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="userStatus">
                                        <label class="form-check-label" for="userStatus">
                                            Aktif
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒ∞ptal</button>
                        <button type="submit" class="btn btn-primary" id="saveUserBtn">
                            <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                            Kaydet
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Rol Ekleme/D√ºzenleme Modal -->
    <div class="modal fade" id="roleModal" tabindex="-1" aria-labelledby="roleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="roleModalLabel">Yeni Rol</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="roleForm">
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="roleName" class="form-label">Rol Adƒ± <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="roleName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="roleDescription" class="form-label">A√ßƒ±klama</label>
                                    <input type="text" class="form-control" id="roleDescription">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Men√º Yetkileri (Geni≈ületilmi≈ü: G√∂r√ºnt√ºleme + CRUD) -->
                        <div class="mb-3">
                            <label class="form-label">Men√º Yetkileri</label>
                            <div class="table-responsive border rounded">
                                <table class="table table-bordered align-middle mb-0" id="menuPermsTable">
                                    <thead class="table-light">
                                        <tr>
                                            <th style="width: 40%">Men√º</th>
                                            <th class="text-center">G√∂r√ºnt√ºleme</th>
                                            <th class="text-center">Olu≈üturma</th>
                                            <th class="text-center">D√ºzenleme</th>
                                            <th class="text-center">Silme</th>
                                        </tr>
                                    </thead>
                                    <tbody id="menuPermsBody">
                                        <tr><td colspan="5" class="text-muted small">Men√ºler y√ºkleniyor...</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒ∞ptal</button>
                        <button type="submit" class="btn btn-primary" id="saveRoleBtn">
                            <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                            Kaydet
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Kategori Ekleme/D√ºzenleme Modal -->
    <div class="modal fade" id="categoryModal" tabindex="-1" aria-labelledby="categoryModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="categoryModalLabel">Yeni Kategori</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="categoryForm">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="categoryTitle" class="form-label">Kategori Adƒ± <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="categoryTitle" required>
                        </div>
                        
                        <div class="mb-3">
                            <label for="categoryOrder" class="form-label">Sƒ±ra <span class="text-danger">*</span></label>
                            <input type="number" class="form-control" id="categoryOrder" min="0" required>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒ∞ptal</button>
                        <button type="submit" class="btn btn-info" id="saveCategoryBtn">
                            <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                            Kaydet
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Men√º Ekleme/D√ºzenleme Modal -->
    <div class="modal fade" id="menuModal" tabindex="-1" aria-labelledby="menuModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="menuModalLabel">Yeni Men√º</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="menuForm">
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="menuTitle" class="form-label">Men√º Adƒ± <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="menuTitle" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="menuCategory" class="form-label">Kategori</label>
                                    <select class="form-select" id="menuCategory">
                                        <option value="">Kategori Se√ßin</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="menuUrl" class="form-label">URL</label>
                                    <input type="text" class="form-control" id="menuUrl" placeholder="/sayfa-adi">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="menuIcon" class="form-label">ƒ∞kon</label>
                                    <input type="text" class="form-control" id="menuIcon" placeholder="ri-dashboard-line">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="menuOrder" class="form-label">Sƒ±ra <span class="text-danger">*</span></label>
                                    <input type="number" class="form-control" id="menuOrder" min="0" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <div class="form-check mt-4">
                                        <input class="form-check-input" type="checkbox" id="menuActive" checked>
                                        <label class="form-check-label" for="menuActive">
                                            Aktif
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒ∞ptal</button>
                        <button type="submit" class="btn btn-primary" id="saveMenuBtn">
                            <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                            Kaydet
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/libs/simplebar/simplebar.min.js"></script>
    <script src="assets/libs/node-waves/waves.min.js"></script>
    <script src="assets/libs/feather-icons/feather.min.js"></script>
    <script src="assets/js/pages/plugins/lord-icon-2.1.0.js"></script>
    <script src="assets/js/plugins.js"></script>
    <script src="assets/js/app.js"></script>
    <script src="assets/js/common.js"></script>
    <script src="assets/js/auth-helpers.js"></script>
    
    <script>
        // Hybrid yakla≈üƒ±m: Men√º sabit, i√ßerik dinamik
        let currentPage = 'dashboard';
        
         // Sayfa y√ºklendiƒüinde
         document.addEventListener('DOMContentLoaded', function() {
             loadUserInfo();
             loadMenus();
             
             // Mevcut URL'den sayfa adƒ±nƒ± al
             const currentPath = window.location.pathname;
             const page = currentPath.substring(1) || 'dashboard';
             
             // URL'yi g√ºncelle
             if (currentPath !== '/dashboard' && currentPath !== '/') {
                 window.history.replaceState({page: page}, '', currentPath);
             } else {
                 window.history.replaceState({page: 'dashboard'}, '', '/dashboard');
             }
             
             currentPage = page;
             loadPageContent(page);
         });

        // ƒ∞√ßerik y√ºkleme fonksiyonu
        async function loadPageContent(page) {
            const contentArea = document.getElementById('dynamicContent');
            const pageTitle = document.getElementById('pageTitle');
            const breadcrumbActive = document.getElementById('breadcrumbActive');
            
            // Loading g√∂ster
            contentArea.innerHTML = `
                <div class="d-flex justify-content-center align-items-center" style="height: 400px;">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Y√ºkleniyor...</span>
                    </div>
                </div>
            `;

            try {
                let content = '';
                let title = '';
                
                switch(page) {
                    case 'dashboard':
                        title = 'Dashboard';
                        content = await loadDashboardContent();
                        break;
                    case 'finans-dashboard':
                        title = 'Finans Dashboard';
                        content = await loadFinansDashboardContent();
                        break;
                    case 'users':
                        title = 'Kullanƒ±cƒ± Y√∂netimi';
                        content = await loadUsersContent();
                        break;
                    case 'roles':
                        title = 'Rol Y√∂netimi';
                        content = await loadRolesContent();
                        break;
                    case 'menus':
                        title = 'Men√º Y√∂netimi';
                        content = await loadMenusContent();
                        break;
                    case 'panel-settings':
                        title = 'Panel Ayarlarƒ±';
                        content = await loadPanelSettingsContent();
                        break;
                    default:
                        title = 'Sayfa Bulunamadƒ±';
                        content = '<div class="alert alert-danger">Sayfa bulunamadƒ±!</div>';
                }
                
                pageTitle.textContent = title;
                breadcrumbActive.textContent = title;
                contentArea.innerHTML = content;
                currentPage = page;
                
            } catch (error) {
                console.error('Content load error:', error);
                contentArea.innerHTML = '<div class="alert alert-danger">ƒ∞√ßerik y√ºklenirken hata olu≈ütu!</div>';
            }
        }

        // Dashboard i√ßeriƒüi
        async function loadDashboardContent() {
            try {
                // Finans admin i√ßin redirect guard (super_admin hari√ß)
                if (currentUser && currentUser.role_name === 'finans_admin') {
                    window.location.href = '/finans-dashboard';
                    return '<div class="alert alert-info">Finans Dashboard\'a y√∂nlendiriliyorsunuz...</div>';
                }
                
                const response = await fetch('/api/dashboard/stats');
                const data = await response.json();
                
                console.log('Dashboard API yanƒ±tƒ±:', data);
                
                if (data.success && data.data) {
                    return `
                        <div class="row">
                            <div class="col-xl-3 col-md-6">
                                <div class="card card-animate">
                                    <div class="card-body">
                                        <div class="d-flex align-items-center">
                                            <div class="flex-grow-1 overflow-hidden">
                                                <p class="text-uppercase fw-medium text-muted text-truncate mb-0">Toplam Kullanƒ±cƒ±</p>
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-end justify-content-between mt-4">
                                            <div>
                                                <h4 class="fs-22 fw-semibold ff-secondary mb-4">${data.data.totalUsers || 0}</h4>
                                            </div>
                                            <div class="avatar-sm flex-shrink-0">
                                                <span class="avatar-title bg-success-subtle rounded fs-3">
                                                    <i class="ri-user-line text-success"></i>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-md-6">
                                <div class="card card-animate">
                                    <div class="card-body">
                                        <div class="d-flex align-items-center">
                                            <div class="flex-grow-1 overflow-hidden">
                                                <p class="text-uppercase fw-medium text-muted text-truncate mb-0">Toplam Rol</p>
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-end justify-content-between mt-4">
                                            <div>
                                                <h4 class="fs-22 fw-semibold ff-secondary mb-4">${data.data.totalRoles || 0}</h4>
                                            </div>
                                            <div class="avatar-sm flex-shrink-0">
                                                <span class="avatar-title bg-info-subtle rounded fs-3">
                                                    <i class="ri-shield-line text-info"></i>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-md-6">
                                <div class="card card-animate">
                                    <div class="card-body">
                                        <div class="d-flex align-items-center">
                                            <div class="flex-grow-1 overflow-hidden">
                                                <p class="text-uppercase fw-medium text-muted text-truncate mb-0">Toplam Men√º</p>
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-end justify-content-between mt-4">
                                            <div>
                                                <h4 class="fs-22 fw-semibold ff-secondary mb-4">${data.data.totalMenus || 0}</h4>
                                            </div>
                                            <div class="avatar-sm flex-shrink-0">
                                                <span class="avatar-title bg-warning-subtle rounded fs-3">
                                                    <i class="ri-menu-line text-warning"></i>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-md-6">
                                <div class="card card-animate">
                                    <div class="card-body">
                                        <div class="d-flex align-items-center">
                                            <div class="flex-grow-1 overflow-hidden">
                                                <p class="text-uppercase fw-medium text-muted text-truncate mb-0">Aktif Kullanƒ±cƒ±</p>
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-end justify-content-between mt-4">
                                            <div>
                                                <h4 class="fs-22 fw-semibold ff-secondary mb-4">${data.data.activeUsers || 0}</h4>
                                            </div>
                                            <div class="avatar-sm flex-shrink-0">
                                                <span class="avatar-title bg-primary-subtle rounded fs-3">
                                                    <i class="ri-user-check-line text-primary"></i>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    return '<div class="alert alert-warning">Dashboard verileri bulunamadƒ±!</div>';
                }
            } catch (error) {
                console.error('Dashboard content error:', error);
            }
            return '<div class="alert alert-danger">Dashboard verileri y√ºklenemedi!</div>';
        }

        // Panel Ayarlarƒ± i√ßeriƒüi
        async function loadPanelSettingsContent() {
            try {
                return `
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h4 class="card-title mb-0">Panel Ayarlarƒ±</h4>
                                    <p class="text-muted mb-0">Panel g√∂r√ºn√ºm√ºn√º ve logolarƒ± y√∂netin</p>
                                </div>
                                <div class="card-body">
                                    <div class="alert alert-info">
                                        <i class="ri-information-line me-2"></i>
                                        Panel ayarlarƒ± sayfasƒ± geli≈ütiriliyor...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                                    <p class="text-muted mb-0">Panel g√∂r√ºn√ºm√ºn√º ve logolarƒ± y√∂netin</p>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <!-- Logo Ayarlarƒ± -->
                                        <div class="col-lg-6">
                                            <div class="border rounded p-4">
                                                <h5 class="mb-3">
                                                    <i class="ri-image-line me-2 text-primary"></i>
                                                    Logo Ayarlarƒ±
                                                </h5>
                                                
                                                <!-- B√ºy√ºk Logo -->
                                                <div class="mb-4">
                                                    <label class="form-label fw-semibold">B√ºy√ºk Logo (Sidebar)</label>
                                                    <div class="d-flex align-items-center mb-3">
                                                        <div class="me-3">
                                                            <img id="currentLargeLogo" src="assets/images/logo-dark.png" alt="B√ºy√ºk Logo" 
                                                                 style="max-width: 120px; max-height: 40px; border: 1px solid #e9ecef; padding: 8px; border-radius: 4px;">
                                                        </div>
                                                        <div class="flex-grow-1">
                                                            <input type="file" class="form-control" id="largeLogoInput" accept="image/*">
                                                            <div class="form-text">√ñnerilen boyut: 120x40px</div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <!-- K√º√ß√ºk Logo -->
                                                <div class="mb-4">
                                                    <label class="form-label fw-semibold">K√º√ß√ºk Logo (Header)</label>
                                                    <div class="d-flex align-items-center mb-3">
                                                        <div class="me-3">
                                                            <img id="currentSmallLogo" src="assets/images/logo-sm.png" alt="K√º√ß√ºk Logo" 
                                                                 style="max-width: 40px; max-height: 40px; border: 1px solid #e9ecef; padding: 8px; border-radius: 4px;">
                                                        </div>
                                                        <div class="flex-grow-1">
                                                            <input type="file" class="form-control" id="smallLogoInput" accept="image/*">
                                                            <div class="form-text">√ñnerilen boyut: 40x40px</div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <!-- Favicon -->
                                                <div class="mb-4">
                                                    <label class="form-label fw-semibold">Favicon</label>
                                                    <div class="d-flex align-items-center mb-3">
                                                        <div class="me-3">
                                                            <img id="currentFavicon" src="assets/images/favicon.ico" alt="Favicon" 
                                                                 style="max-width: 32px; max-height: 32px; border: 1px solid #e9ecef; padding: 4px; border-radius: 4px;">
                                                        </div>
                                                        <div class="flex-grow-1">
                                                            <input type="file" class="form-control" id="faviconInput" accept="image/*,.ico">
                                                            <div class="form-text">√ñnerilen boyut: 32x32px veya .ico dosyasƒ±</div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <button type="button" class="btn btn-primary" onclick="saveLogos()">
                                                    <i class="ri-save-line me-1"></i>
                                                    Logolarƒ± Kaydet
                                                </button>
                                            </div>
                                        </div>
                                        
                                        <!-- √ñnizleme -->
                                        <div class="col-lg-6">
                                            <div class="border rounded p-4">
                                                <h5 class="mb-3">
                                                    <i class="ri-eye-line me-2 text-success"></i>
                                                    √ñnizleme
                                                </h5>
                                                
                                                <!-- Sidebar √ñnizleme -->
                                                <div class="mb-4">
                                                    <label class="form-label fw-semibold">Sidebar √ñnizleme</label>
                                                    <div class="bg-dark p-3 rounded" style="width: 200px;">
                                                        <div class="text-white mb-2">
                                                            <img id="previewLargeLogo" src="assets/images/logo-dark.png" alt="Logo" 
                                                                 style="max-width: 120px; max-height: 30px;">
                                                        </div>
                                                        <div class="text-muted small">VELZON</div>
                                                    </div>
                                                </div>
                                                
                                                <!-- Header √ñnizleme -->
                                                <div class="mb-4">
                                                    <label class="form-label fw-semibold">Header √ñnizleme</label>
                                                    <div class="border p-3 rounded bg-light">
                                                        <div class="d-flex align-items-center">
                                                            <img id="previewSmallLogo" src="assets/images/logo-sm.png" alt="Logo" 
                                                                 style="max-width: 30px; max-height: 30px;" class="me-2">
                                                            <span class="fw-bold">VELZON</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <!-- Favicon √ñnizleme -->
                                                <div>
                                                    <label class="form-label fw-semibold">Favicon √ñnizleme</label>
                                                    <div class="border p-3 rounded bg-light">
                                                        <div class="d-flex align-items-center">
                                                            <img id="previewFavicon" src="assets/images/favicon.ico" alt="Favicon" 
                                                                 style="max-width: 24px; max-height: 24px;" class="me-2">
                                                            <span>Tarayƒ±cƒ± sekmesi</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <script>
                        // Logo √∂nizleme fonksiyonlarƒ±
                        document.getElementById('largeLogoInput').addEventListener('change', function(e) {
                            const file = e.target.files[0];
                            if (file) {
                                const reader = new FileReader();
                                reader.onload = function(e) {
                                    document.getElementById('currentLargeLogo').src = e.target.result;
                                    document.getElementById('previewLargeLogo').src = e.target.result;
                                };
                                reader.readAsDataURL(file);
                            }
                        });
                        
                        document.getElementById('smallLogoInput').addEventListener('change', function(e) {
                            const file = e.target.files[0];
                            if (file) {
                                const reader = new FileReader();
                                reader.onload = function(e) {
                                    document.getElementById('currentSmallLogo').src = e.target.result;
                                    document.getElementById('previewSmallLogo').src = e.target.result;
                                };
                                reader.readAsDataURL(file);
                            }
                        });
                        
                        document.getElementById('faviconInput').addEventListener('change', function(e) {
                            const file = e.target.files[0];
                            if (file) {
                                const reader = new FileReader();
                                reader.onload = function(e) {
                                    document.getElementById('currentFavicon').src = e.target.result;
                                    document.getElementById('previewFavicon').src = e.target.result;
                                };
                                reader.readAsDataURL(file);
                            }
                        });
                        
                        // Logo kaydetme fonksiyonu
                        async function saveLogos() {
                            const largeLogoFile = document.getElementById('largeLogoInput').files[0];
                            const smallLogoFile = document.getElementById('smallLogoInput').files[0];
                            const faviconFile = document.getElementById('faviconInput').files[0];
                            
                            if (!largeLogoFile && !smallLogoFile && !faviconFile) {
                                showAlert('warning', 'L√ºtfen en az bir dosya se√ßin');
                                return;
                            }
                            
                            const formData = new FormData();
                            if (largeLogoFile) formData.append('largeLogo', largeLogoFile);
                            if (smallLogoFile) formData.append('smallLogo', smallLogoFile);
                            if (faviconFile) formData.append('favicon', faviconFile);
                            
                            try {
                                const response = await fetch('/api/panel-settings/logos', {
                                    method: 'POST',
                                    body: formData
                                });
                                
                                const data = await response.json();
                                
                                if (data.success) {
                                    showAlert('success', 'Logolar ba≈üarƒ±yla kaydedildi');
                                    // Form'u temizle
                                    document.getElementById('largeLogoInput').value = '';
                                    document.getElementById('smallLogoInput').value = '';
                                    document.getElementById('faviconInput').value = '';
                                } else {
                                    showAlert('danger', data.message || 'Kaydetme hatasƒ±');
                                }
                            } catch (error) {
                                console.error('Logo kaydetme hatasƒ±:', error);
                                showAlert('danger', 'Sunucu hatasƒ±');
                            }
                        }
                    </script>
                `;
            } catch (error) {
                console.error('Panel settings content error:', error);
                return '<div class="alert alert-danger">Panel ayarlarƒ± y√ºklenirken hata olu≈ütu!</div>';
            }
        }

        // Finans admin dashboard
        async function loadFinansDashboardContent() {
            try {
                // Super admin her yere eri≈üebilir, redirect guard kaldƒ±rƒ±ldƒ±
                
                const statsRes = await fetch('/api/dashboard/finans-stats');
                const statsData = await statsRes.json();
                const stats = statsData.success ? statsData.data : { toplamHesap: 0, bugunIslem: 0, bakiye: 0 };
                return `
                    <div class="row g-3">
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-body">
                                    <div class="d-flex align-items-center">
                                        <div class="flex-shrink-0 me-3"><i class="ri-bank-card-line fs-3 text-primary"></i></div>
                                        <div class="flex-grow-1">
                                            <h6 class="mb-1">Toplam Hesap</h6>
                                            <h4 class="mb-0">${stats.toplamHesap || 0}</h4>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-body">
                                    <div class="d-flex align-items-center">
                                        <div class="flex-shrink-0 me-3"><i class="ri-exchange-dollar-line fs-3 text-success"></i></div>
                                        <div class="flex-grow-1">
                                            <h6 class="mb-1">Bug√ºnk√º ƒ∞≈ülem</h6>
                                            <h4 class="mb-0">${stats.bugunIslem || 0}</h4>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-body">
                                    <div class="d-flex align-items-center">
                                        <div class="flex-shrink-0 me-3"><i class="ri-wallet-3-line fs-3 text-warning"></i></div>
                                        <div class="flex-grow-1">
                                            <h6 class="mb-1">Toplam Bakiye</h6>
                                            <h4 class="mb-0">${stats.bakiye || 0}</h4>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } catch (e) {
                console.error('Finans dashboard y√ºklenemedi', e);
                return '<div class="alert alert-danger">Finans dashboard y√ºklenemedi</div>';
            }
        }

        // Kullanƒ±cƒ± y√∂netimi i√ßeriƒüi
        async function loadUsersContent() {
            try {
                const response = await fetch('/api/users?page=1&limit=10&search=');
                const data = await response.json();
                
                if (data.success) {
                    let usersHtml = `
                        <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <div class="row align-items-center">
                                            <div class="col">
                                                <h4 class="card-title mb-0">Kullanƒ±cƒ± Y√∂netimi</h4>
                                            </div>
                                            <div class="col-auto">
                                                <button class="btn btn-primary" id="addUserBtn">
                                                    <i class="ri-add-line me-1"></i> Yeni Kullanƒ±cƒ±
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-body">
                                        <!-- Filtreler -->
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <div class="search-box">
                                                    <input type="text" class="form-control" placeholder="Kullanƒ±cƒ± ara..." id="searchInput">
                                                    <i class="ri-search-line search-icon"></i>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Kullanƒ±cƒ± Tablosu -->
                                        <div class="table-responsive">
                                            <table class="table table-bordered table-nowrap align-middle mb-0">
                                                <thead class="table-light">
                                                    <tr>
                                                        <th scope="col">ID</th>
                                                        <th scope="col">Ad Soyad</th>
                                                        <th scope="col">E-posta</th>
                                                        <th scope="col">Rol</th>
                                                        <th scope="col">Durum</th>
                                                        <th scope="col">Son Giri≈ü</th>
                                                        <th scope="col">ƒ∞≈ülemler</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="usersTableBody">
                    `;
                    
                    data.data.users.forEach(user => {
                        usersHtml += `
                            <tr>
                                <td>${user.id}</td>
                                <td>${user.name}</td>
                                <td>${user.email}</td>
                                <td><span class="badge bg-primary">${user.role_name || 'Rol Yok'}</span></td>
                                <td>
                                    <span class="badge ${user.is_active ? 'bg-success' : 'bg-danger'}">
                                        ${user.is_active ? 'Aktif' : 'Pasif'}
                                    </span>
                                </td>
                                <td>${user.last_login ? new Date(user.last_login).toLocaleString('tr-TR') : 'Hi√ß giri≈ü yapmamƒ±≈ü'}</td>
                                <td>
                                    <div class="dropdown">
                                        <button class="btn btn-soft-secondary btn-sm dropdown" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                            <i class="ri-more-fill align-middle"></i>
                                        </button>
                                        <ul class="dropdown-menu dropdown-menu-end">
                                            <li><a class="dropdown-item edit-user-btn" href="#" data-user-id="${user.id}"><i class="ri-pencil-fill align-bottom me-2 text-muted"></i> D√ºzenle</a></li>
                                            <li><a class="dropdown-item delete-user-btn" href="#" data-user-id="${user.id}"><i class="ri-delete-bin-fill align-bottom me-2 text-muted"></i> Sil</a></li>
                                        </ul>
                                    </div>
                                </td>
                            </tr>
                        `;
                    });
                    
                    usersHtml += `
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    return usersHtml;
                }
            } catch (error) {
                console.error('Users content error:', error);
            }
            return '<div class="alert alert-danger">Kullanƒ±cƒ± verileri y√ºklenemedi!</div>';
        }

        // Rol y√∂netimi i√ßeriƒüi
        async function loadRolesContent() {
            try {
                const response = await fetch('/api/roles');
                const data = await response.json();
                
                if (data.success) {
                    let rolesHtml = `
                        <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <div class="row align-items-center">
                                            <div class="col">
                                                <h4 class="card-title mb-0">Rol Y√∂netimi</h4>
                                            </div>
                                            <div class="col-auto">
                                                <button class="btn btn-primary" id="addRoleBtn">
                                                    <i class="ri-add-line me-1"></i> Yeni Rol
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-body">
                                        <!-- Rol Tablosu -->
                                        <div class="table-responsive">
                                            <table class="table table-bordered table-nowrap align-middle mb-0">
                                                <thead class="table-light">
                                                    <tr>
                                                        <th scope="col">ID</th>
                                                        <th scope="col">Rol Adƒ±</th>
                                                        <th scope="col">A√ßƒ±klama</th>
                                                        <th scope="col">Durum</th>
                                                        <th scope="col">Olu≈üturulma</th>
                                                        <th scope="col">ƒ∞≈ülemler</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="rolesTableBody">
                    `;
                    
                    data.data.roles.forEach(role => {
                        rolesHtml += `
                            <tr>
                                <td>${role.id}</td>
                                <td><span class="badge bg-primary">${role.name}</span></td>
                                <td>${role.description || '-'}</td>
                                <td>
                                    <span class="badge ${role.is_active ? 'bg-success' : 'bg-danger'}">
                                        ${role.is_active ? 'Aktif' : 'Pasif'}
                                    </span>
                                </td>
                                <td>${new Date(role.created_at).toLocaleString('tr-TR')}</td>
                                <td>
                                    <div class="dropdown">
                                        <button class="btn btn-soft-secondary btn-sm dropdown" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                            <i class="ri-more-fill align-middle"></i>
                                        </button>
                                        <ul class="dropdown-menu dropdown-menu-end">
                                            <li><a class="dropdown-item edit-role-btn" href="#" data-role-id="${role.id}"><i class="ri-pencil-fill align-bottom me-2 text-muted"></i> D√ºzenle</a></li>
                                            <li><a class="dropdown-item delete-role-btn" href="#" data-role-id="${role.id}"><i class="ri-delete-bin-fill align-bottom me-2 text-muted"></i> Sil</a></li>
                                        </ul>
                                    </div>
                                </td>
                            </tr>
                        `;
                    });
                    
                    rolesHtml += `
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    return rolesHtml;
                }
            } catch (error) {
                console.error('Roles content error:', error);
            }
            return '<div class="alert alert-danger">Rol verileri y√ºklenemedi!</div>';
        }

        // Men√º y√∂netimi i√ßeriƒüi
        async function loadMenusContent() {
            try {
                const response = await fetch('/api/menus');
                const data = await response.json();
                
                if (data.success) {
                    // Men√ºleri global deƒüi≈ükene kaydet
                    menus = data.data.menus;
                    
                    // Kategorileri ve men√ºleri ayƒ±r
                    const categories = data.data.menus.filter(menu => menu.is_category);
                    const menuItems = data.data.menus.filter(menu => !menu.is_category);
                    
                    let menusHtml = `
                        <div class="row">
                            <!-- Kategori Listesi -->
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <div class="row align-items-center">
                                            <div class="col">
                                                <h5 class="card-title mb-0">Kategoriler</h5>
                                            </div>
                                            <div class="col-auto">
                                                <button class="btn btn-info" id="addCategoryBtn">
                                                    <i class="ri-folder-add-line align-bottom me-1"></i> Yeni Kategori
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table table-bordered table-nowrap align-middle mb-0">
                                                <thead class="table-light">
                                                    <tr>
                                                        <th scope="col">Sƒ±ra</th>
                                                        <th scope="col">Kategori Adƒ±</th>
                                                        <th scope="col">ƒ∞kon</th>
                                                        <th scope="col">URL</th>
                                                        <th scope="col">Durum</th>
                                                        <th scope="col">ƒ∞≈ülemler</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="categoriesTableBody">
                    `;
                    
                    // Kategorileri g√∂ster
                    if (categories.length === 0) {
                        menusHtml += `
                            <tr>
                                <td colspan="6" class="text-center text-muted py-4">
                                    <i class="ri-folder-line fs-48 mb-3 d-block"></i>
                                    <p class="mb-0">Hen√ºz kategori eklenmemi≈ü</p>
                                    <small>Yeni kategori eklemek i√ßin "Yeni Kategori" butonunu kullanƒ±n</small>
                                </td>
                            </tr>
                        `;
                    } else {
                        categories.sort((a, b) => a.order_index - b.order_index).forEach(category => {
                            menusHtml += `
                                <tr>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="ri-drag-move-2-line me-2 text-muted" style="cursor: move;"></i>
                                            <span class="fw-bold">${category.order_index}</span>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="${category.icon} me-2 text-primary"></i>
                                            <span class="fw-bold">${category.title}</span>
                                        </div>
                                    </td>
                                    <td><code>${category.icon || '-'}</code></td>
                                    <td><code>${category.url || '#'}</code></td>
                                    <td>
                                        <span class="badge ${category.is_active ? 'bg-success' : 'bg-danger'}">
                                            ${category.is_active ? 'Aktif' : 'Pasif'}
                                        </span>
                                    </td>
                                    <td>
                                        <div class="dropdown">
                                            <button class="btn btn-soft-secondary btn-sm dropdown" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                                <i class="ri-more-fill align-middle"></i>
                                            </button>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li><a class="dropdown-item edit-category-btn" href="#" data-category-id="${category.id}" data-category-title="${category.title}" data-category-order="${category.order_index}"><i class="ri-pencil-fill align-bottom me-2 text-muted"></i> Kategoriyi D√ºzenle</a></li>
                                                <li><a class="dropdown-item delete-category-btn" href="#" data-category-id="${category.id}"><i class="ri-delete-bin-fill align-bottom me-2 text-muted"></i> Kategoriyi Sil</a></li>
                                            </ul>
                                        </div>
                                    </td>
                                </tr>
                            `;
                        });
                    }
                    
                    menusHtml += `
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <!-- Men√º Listesi -->
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <div class="row align-items-center">
                                            <div class="col">
                                                <h5 class="card-title mb-0">Men√ºler</h5>
                                            </div>
                                            <div class="col-auto">
                                                <div class="d-flex gap-1">
                                                    <button class="btn btn-primary" id="addMenuBtn">
                                                        <i class="ri-add-line align-bottom me-1"></i> Yeni Men√º
                                                    </button>
                                                    <button class="btn btn-success" id="saveOrderBtn" style="display: none;">
                                                        <i class="ri-save-line align-bottom me-1"></i> Sƒ±ralamayƒ± Kaydet
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table table-bordered table-nowrap align-middle mb-0">
                                                <thead class="table-light">
                                                    <tr>
                                                        <th scope="col">Sƒ±ra</th>
                                                        <th scope="col">Men√º Adƒ±</th>
                                                        <th scope="col">Kategori</th>
                                                        <th scope="col">URL</th>
                                                        <th scope="col">ƒ∞kon</th>
                                                        <th scope="col">Durum</th>
                                                        <th scope="col">ƒ∞≈ülemler</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="menusTableBody">
                    `;
                    
                    // Men√ºleri g√∂ster
                    if (menuItems.length === 0) {
                        menusHtml += `
                            <tr>
                                <td colspan="7" class="text-center text-muted py-4">
                                    <i class="ri-menu-line fs-48 mb-3 d-block"></i>
                                    <p class="mb-0">Hen√ºz men√º eklenmemi≈ü</p>
                                    <small>Yeni men√º eklemek i√ßin "Yeni Men√º" butonunu kullanƒ±n</small>
                                </td>
                            </tr>
                        `;
                    } else {
                        // Kategorilere g√∂re grupla
                        const menuCategories = {};
                        menuItems.forEach(menu => {
                            const categoryName = menu.category || 'Kategori Yok';
                            if (!menuCategories[categoryName]) {
                                menuCategories[categoryName] = [];
                            }
                            menuCategories[categoryName].push(menu);
                        });
                        
                        // Kategorileri sƒ±rala (kategori order_index'ine g√∂re)
                        const sortedCategoryNames = Object.keys(menuCategories).sort((a, b) => {
                            // Her kategorinin ilk men√ºs√ºn√ºn order_index'ini kullan
                            const categoryA = categories.find(cat => cat.title === a || cat.category === a);
                            const categoryB = categories.find(cat => cat.title === b || cat.category === b);
                            return (categoryA?.order_index || 0) - (categoryB?.order_index || 0);
                        });
                        
                        // Her kategori i√ßin men√ºleri render et
                        sortedCategoryNames.forEach(categoryName => {
                            const categoryMenus = menuCategories[categoryName];
                            const categoryBadgeClass = categoryName !== 'Kategori Yok' ? 'bg-secondary' : 'bg-danger';
                            
                            // Kategori ba≈ülƒ±ƒüƒ± ekle
                            menusHtml += `
                                <tr class="table-info">
                                    <td colspan="7" class="fw-bold text-primary">
                                        <i class="ri-folder-line me-2"></i>${categoryName}
                                    </td>
                                </tr>
                            `;
                            
                            // Kategori altƒ±ndaki men√ºleri sƒ±ralƒ± olarak g√∂ster
                            categoryMenus.sort((a, b) => a.order_index - b.order_index).forEach(menu => {
                                menusHtml += `
                                    <tr>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <i class="ri-drag-move-2-line me-2 text-muted" style="cursor: move;"></i>
                                                <span>${menu.order_index}</span>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <i class="${menu.icon} me-2 text-secondary"></i>
                                                <span>${menu.title}</span>
                                            </div>
                                        </td>
                                        <td>
                                            <span class="badge ${categoryBadgeClass}">${categoryName}</span>
                                        </td>
                                        <td><code>${menu.url || '-'}</code></td>
                                        <td><code>${menu.icon || '-'}</code></td>
                                        <td>
                                            <span class="badge ${menu.is_active ? 'bg-success' : 'bg-danger'}">
                                                ${menu.is_active ? 'Aktif' : 'Pasif'}
                                            </span>
                                        </td>
                                        <td>
                                            <div class="dropdown">
                                                <button class="btn btn-soft-secondary btn-sm dropdown" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                                    <i class="ri-more-fill align-middle"></i>
                                                </button>
                                                <ul class="dropdown-menu dropdown-menu-end">
                                                    <li><a class="dropdown-item edit-menu-btn" href="#" 
                                                        data-menu-id="${menu.id}"
                                                        data-menu-title="${menu.title}"
                                                        data-menu-url="${menu.url || ''}"
                                                        data-menu-icon="${menu.icon || ''}"
                                                        data-menu-order="${menu.order_index}"
                                                        data-menu-category="${menu.category || ''}"
                                                        data-menu-active="${menu.is_active}">
                                                        <i class="ri-pencil-fill align-bottom me-2 text-muted"></i> Men√ºy√º D√ºzenle</a></li>
                                                    <li><a class="dropdown-item delete-menu-btn" href="#" data-menu-id="${menu.id}"><i class="ri-delete-bin-fill align-bottom me-2 text-muted"></i> Men√ºy√º Sil</a></li>
                                                </ul>
                                            </div>
                                        </td>
                                    </tr>
                                `;
                            });
                        });
                    }
                    
                    menusHtml += `
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    return menusHtml;
                }
            } catch (error) {
                console.error('Menus content error:', error);
            }
            return '<div class="alert alert-danger">Men√º verileri y√ºklenemedi!</div>';
        }

         // Men√º linklerine tƒ±klama olayƒ±
         document.addEventListener('click', function(e) {
             if (e.target.closest('.menu-link')) {
                 e.preventDefault();
                 const menuLink = e.target.closest('.menu-link');
                 const href = menuLink.getAttribute('href');
                 
                 console.log('Men√º linkine tƒ±klandƒ±:', href);
                 
                 if (href && href.startsWith('/')) {
                     // URL'den sayfa adƒ±nƒ± √ßƒ±kar
                     const page = href.substring(1);
                     if (page && page !== currentPage) {
                         // URL'yi g√ºncelle (tarayƒ±cƒ± ge√ßmi≈üine ekle)
                         window.history.pushState({page: page}, '', href);
                         
                         // Aktif men√ºy√º g√ºncelle
                         document.querySelectorAll('.menu-link').forEach(link => {
                             link.classList.remove('active');
                         });
                         menuLink.classList.add('active');
                         
                         loadPageContent(page);
                     }
                 }
             }
         });

         // Browser back/forward butonlarƒ± i√ßin
         window.addEventListener('popstate', function(event) {
             if (event.state && event.state.page) {
                 const page = event.state.page;
                 currentPage = page;
                 
                 // Aktif men√ºy√º g√ºncelle
                 document.querySelectorAll('.menu-link').forEach(link => {
                     link.classList.remove('active');
                     if (link.getAttribute('href') === '/' + page) {
                         link.classList.add('active');
                     }
                 });
                 
                 loadPageContent(page);
             } else {
                 // Varsayƒ±lan olarak dashboard'a git
                 window.history.pushState({page: 'dashboard'}, '', '/dashboard');
                 loadPageContent('dashboard');
             }
         });

         // ========== CRUD FONKSƒ∞YONLARI ==========
         
         // Global deƒüi≈ükenler
         let currentUserId = null;
         let currentRoleId = null;
         let currentMenuId = null;
         let currentCategoryId = null;
         let roles = [];
         let menus = [];

         // Event delegation i√ßin global event listener
         document.addEventListener('click', function(e) {
             // Logout butonu
             if (e.target.closest('[data-logout]')) {
                 e.preventDefault();
                 logout();
                 return;
             }
             
             // Kullanƒ±cƒ± y√∂netimi butonlarƒ±
             if (e.target.closest('#addUserBtn')) {
                 e.preventDefault();
                 showUserModal();
             }
             
             if (e.target.closest('.edit-user-btn')) {
                 e.preventDefault();
                 const userId = e.target.closest('.edit-user-btn').dataset.userId;
                 editUser(userId);
             }
             
             if (e.target.closest('.delete-user-btn')) {
                 e.preventDefault();
                 const userId = e.target.closest('.delete-user-btn').dataset.userId;
                 deleteUser(userId);
             }
             
             // Rol y√∂netimi butonlarƒ±
             if (e.target.closest('#addRoleBtn')) {
                 e.preventDefault();
                 showRoleModal();
             }
             
             if (e.target.closest('.edit-role-btn')) {
                 e.preventDefault();
                 const roleId = e.target.closest('.edit-role-btn').dataset.roleId;
                 editRole(roleId);
             }
             
             if (e.target.closest('.delete-role-btn')) {
                 e.preventDefault();
                 const roleId = e.target.closest('.delete-role-btn').dataset.roleId;
                 deleteRole(roleId);
             }
             
             // Men√º y√∂netimi butonlarƒ±
             if (e.target.closest('#addCategoryBtn')) {
                 e.preventDefault();
                 showCategoryModal();
             }
             
             if (e.target.closest('#addMenuBtn')) {
                 e.preventDefault();
                 showMenuModal();
             }
             
             if (e.target.closest('.edit-menu-btn')) {
                 e.preventDefault();
                 const btn = e.target.closest('.edit-menu-btn');
                 const menuId = btn.dataset.menuId;
                 // Fallback: eƒüer API hata verirse en azƒ±ndan UI'yƒ± dolduralƒ±m
                 const fallbackTitle = btn.dataset.menuTitle;
                 const fallbackUrl = btn.dataset.menuUrl;
                 const fallbackIcon = btn.dataset.menuIcon;
                 const fallbackOrder = parseInt(btn.dataset.menuOrder);
                 const fallbackCategory = btn.dataset.menuCategory;
                 const fallbackActive = btn.dataset.menuActive === 'true';
                 
                 // √ñnce kategori dropdown'unu g√ºncelle
                 updateMenuCategorySelect();
                 
                 // Sonra fallback deƒüerlerini form alanlarƒ±na yaz
                 if (fallbackTitle) document.getElementById('menuTitle').value = fallbackTitle;
                 if (fallbackUrl) document.getElementById('menuUrl').value = fallbackUrl;
                 if (fallbackIcon) document.getElementById('menuIcon').value = fallbackIcon;
                 if (!Number.isNaN(fallbackOrder)) document.getElementById('menuOrder').value = fallbackOrder;
                 if (fallbackCategory) document.getElementById('menuCategory').value = fallbackCategory;
                 document.getElementById('menuActive').checked = fallbackActive;
                 
                 editMenu(menuId);
             }
             
             if (e.target.closest('.delete-menu-btn')) {
                 e.preventDefault();
                 const menuId = e.target.closest('.delete-menu-btn').dataset.menuId;
                 deleteMenu(menuId);
             }
             
             // Kategori butonlarƒ±
            if (e.target.closest('.edit-category-btn')) {
                e.preventDefault();
                const btn = e.target.closest('.edit-category-btn');
                const categoryId = btn.dataset.categoryId;
                // API ba≈üarƒ±sƒ±z olursa kullanƒ±lacak fallback
                const fallbackTitle = btn.dataset.categoryTitle;
                const fallbackOrder = parseInt(btn.dataset.categoryOrder);
                // Fallback deƒüerlerini form alanlarƒ±na √∂nceden yaz
                if (fallbackTitle) document.getElementById('categoryTitle').value = fallbackTitle;
                if (!Number.isNaN(fallbackOrder)) document.getElementById('categoryOrder').value = fallbackOrder;
                editCategory(categoryId);
            }
             
             if (e.target.closest('.delete-category-btn')) {
                 e.preventDefault();
                 const categoryId = e.target.closest('.delete-category-btn').dataset.categoryId;
                 deleteCategory(categoryId);
             }
         });

         // Form event listener'larƒ±
         document.addEventListener('submit', function(e) {
             if (e.target.id === 'userForm') {
                 e.preventDefault();
                 saveUser();
             }
             
             if (e.target.id === 'roleForm') {
                 e.preventDefault();
                 saveRole();
             }
             
             if (e.target.id === 'categoryForm') {
                 e.preventDefault();
                 saveCategory();
             }
             
             if (e.target.id === 'menuForm') {
                 e.preventDefault();
                 saveMenu();
             }
         });

         // ========== KULLANICI Y√ñNETƒ∞Mƒ∞ FONKSƒ∞YONLARI ==========
         
        async function loadRoles() {
             try {
                const response = await fetch(`/api/roles?ts=${Date.now()}`, { cache: 'no-store' });
                 const data = await response.json();
                 
                if (data.success) {
                     roles = data.data.roles;
                    const roleSelect = document.getElementById('newUserRole');
                     if (roleSelect) {
                    const activeRoles = roles.filter(r => r.is_active !== false);
                        // Sadece native select doldur (en g√ºvenli yol)
                        roleSelect.innerHTML = '<option value="">Rol se√ßin</option>';
                        if (activeRoles.length === 0) {
                            const opt = document.createElement('option');
                            opt.value = '';
                            opt.textContent = 'Aktif rol bulunamadƒ±';
                            roleSelect.appendChild(opt);
                        }
                        activeRoles.forEach(role => {
                            const option = document.createElement('option');
                            option.value = role.id;
                            option.textContent = role.name;
                            roleSelect.appendChild(option);
                        });
                     }
                } else {
                    console.error('Roles load failed:', data.message);
                    showAlert && showAlert('danger', 'Roller y√ºklenemedi');
                 }
             } catch (error) {
                 console.error('Roles load error:', error);
                showAlert && showAlert('danger', 'Roller y√ºklenirken hata olu≈ütu');
             }
         }

         function showUserModal(userId = null) {
             currentUserId = userId;
            const userModalEl = document.getElementById('userModal');
            const modal = new bootstrap.Modal(userModalEl);
             const modalTitle = document.getElementById('userModalLabel');
             const statusRow = document.getElementById('userStatusRow');
            // Modal tamamen g√∂sterildiƒüinde rol listesini tazele (DOM hazƒ±r garantisi)
            const onShown = () => {
                // Render sonrasƒ± kƒ±sa bir gecikmeyle select element garanti
                setTimeout(() => { if (typeof loadRoles === 'function') loadRoles(); }, 0);
                userModalEl.removeEventListener('shown.bs.modal', onShown);
            };
            userModalEl.addEventListener('shown.bs.modal', onShown);
             
             if (userId) {
                 modalTitle.textContent = 'Kullanƒ±cƒ± D√ºzenle';
                 statusRow.style.display = 'block';
                 loadUserForEdit(userId);
             } else {
                 modalTitle.textContent = 'Yeni Kullanƒ±cƒ±';
                 statusRow.style.display = 'none';
                 document.getElementById('userForm').reset();
                // Rol select'i temizle
                const roleSelect = document.getElementById('newUserRole');
                if (roleSelect) roleSelect.innerHTML = '<option value="">Rol se√ßin</option>';
             }
             
             modal.show();
         }

         async function loadUserForEdit(userId) {
             try {
                 const response = await fetch(`/api/users/${userId}`);
                 const data = await response.json();
                 
                 if (data.success) {
                     const user = data.data.user;
                     document.getElementById('userName').value = user.name;
                     document.getElementById('userEmail').value = user.email;
                     document.getElementById('userRole').value = user.role_id;
                     document.getElementById('userStatus').checked = user.is_active;
                     document.getElementById('userPassword').required = false;
                 }
             } catch (error) {
                 console.error('User load error:', error);
             }
         }

         async function saveUser() {
             const saveBtn = document.getElementById('saveUserBtn');
             const spinner = saveBtn.querySelector('.spinner-border');
             
             saveBtn.disabled = true;
             spinner.classList.remove('d-none');
             
            try {
                const modalRoot = document.getElementById('userModal');
                const nameEl = modalRoot?.querySelector('#userName');
                const emailEl = modalRoot?.querySelector('#userEmail');
                const roleEl = modalRoot?.querySelector('#newUserRole');
                const passEl = modalRoot?.querySelector('#userPassword');

                const name = (nameEl?.value || '').trim();
                const email = (emailEl?.value || '').trim();
                const roleId = parseInt(roleEl?.value || '');

                if (!name) { showAlert('danger', 'Ad Soyad zorunludur'); throw new Error('validation'); }
                if (!email) { showAlert('danger', 'E-posta zorunludur'); throw new Error('validation'); }
                if (!roleId || isNaN(roleId)) { showAlert('danger', 'L√ºtfen bir rol se√ßin'); throw new Error('validation'); }

                const userData = { name, email, role_id: roleId };
                 
                 if (!currentUserId) {
                    const password = passEl?.value || '';
                    if (!password) { showAlert('danger', '≈ûifre zorunludur'); throw new Error('validation'); }
                    userData.password = password;
                 } else {
                    userData.is_active = document.getElementById('userStatus').checked;
                 }
                 
                 const url = currentUserId ? `/api/users/${currentUserId}` : '/api/users';
                 const method = currentUserId ? 'PUT' : 'POST';
                 
                 const response = await fetch(url, {
                     method: method,
                     headers: {
                         'Content-Type': 'application/json',
                     },
                     body: JSON.stringify(userData)
                 });
                 
                const data = await response.json();
                
                if (data.success) {
                     bootstrap.Modal.getInstance(document.getElementById('userModal')).hide();
                     loadUsersContent();
                     showAlert('success', data.message);
                 } else {
                    const detail = data.errors ? `: ${data.errors.join(', ')}` : '';
                    showAlert('danger', data.message + detail);
                 }
             } catch (error) {
                if (error && error.message === 'validation') {
                    // zaten kullanƒ±cƒ±ya g√∂sterildi
                } else {
                    console.error('Save user error:', error);
                    showAlert('danger', 'Sunucu hatasƒ±. L√ºtfen tekrar deneyin.');
                }
             } finally {
                 saveBtn.disabled = false;
                 spinner.classList.add('d-none');
             }
         }

         async function editUser(userId) {
             showUserModal(userId);
         }

         async function deleteUser(userId) {
             showDeleteConfirmation('Bu kullanƒ±cƒ±yƒ± silmek istediƒüinizden emin misiniz?', async () => {
                 try {
                     const response = await fetch(`/api/users/${userId}`, {
                         method: 'DELETE'
                     });
                     
                     const data = await response.json();
                     
                     if (data.success) {
                         loadUsersContent();
                         showAlert('success', data.message);
                     } else {
                         showAlert('danger', data.message);
                     }
                 } catch (error) {
                     console.error('Delete user error:', error);
                     showAlert('danger', 'Sunucu hatasƒ±. L√ºtfen tekrar deneyin.');
                 }
             });
         }

         // ========== ROL Y√ñNETƒ∞Mƒ∞ FONKSƒ∞YONLARI ==========
         
         function showRoleModal(roleId = null) {
             currentRoleId = roleId;
             const modal = new bootstrap.Modal(document.getElementById('roleModal'));
             const modalTitle = document.getElementById('roleModalLabel');
             
            // Men√º izin alanƒ±nƒ± ilk haline getir
            renderMenuPermissionsSkeleton();

             if (roleId) {
                 modalTitle.textContent = 'Rol D√ºzenle';
                 loadRoleForEdit(roleId);
                // Rol mevcutken men√º yetkilerini de y√ºkle
                loadRoleMenuPermissions(roleId);
             } else {
                 modalTitle.textContent = 'Yeni Rol';
                 document.getElementById('roleForm').reset();
                 clearPermissions();
                // Yeni rol i√ßin t√ºm men√º listesini getir ve bo≈ü se√ßimle √ßiz
                loadAllMenusForPermissions();
             }
             
             modal.show();
         }

         async function loadRoleForEdit(roleId) {
             try {
                 const response = await fetch(`/api/roles/${roleId}`);
                 const data = await response.json();
                 
                 if (data.success) {
                     const role = data.data.role;
                     document.getElementById('roleName').value = role.name;
                     document.getElementById('roleDescription').value = role.description || '';
                     
                     // Yetkileri y√ºkle
                     clearPermissions();
                     if (role.permissions) {
                         Object.keys(role.permissions).forEach(module => {
                             Object.keys(role.permissions[module]).forEach(action => {
                                 const checkboxId = `${module}_${action}`;
                                 const checkbox = document.getElementById(checkboxId);
                                 if (checkbox) {
                                     checkbox.checked = role.permissions[module][action];
                                 }
                             });
                         });
                     }
                 }
             } catch (error) {
                 console.error('Role load error:', error);
             }
         }

         function clearPermissions() {
             const checkboxes = document.querySelectorAll('input[type="checkbox"]');
             checkboxes.forEach(checkbox => {
                 checkbox.checked = false;
             });
         }

        function renderMenuPermissionsSkeleton() {
            const container = document.getElementById('menuPermissionsContainer');
            if (!container) return;
            container.innerHTML = '<div class="text-muted small">Men√ºler y√ºkleniyor...</div>';
        }

        async function loadAllMenusForPermissions() {
            try {
                const res = await fetch('/api/menus');
                const data = await res.json();
                if (data.success) {
                    renderMenuPermissions(data.data.menus, []);
                }
            } catch (e) {
                console.error('Men√ºler y√ºklenemedi', e);
            }
        }

        function renderMenuPermissions(allMenus, roleMenuPerms) {
            const containerBody = document.getElementById('menuPermsBody');
            if (!containerBody) return;
            const permById = new Map((roleMenuPerms || []).map(p => [p.menu_id, p]));
            const items = allMenus.filter(m => !m.is_category).sort((a,b)=>a.order_index-b.order_index);
            let rows = '';
            items.forEach(m => {
                const p = permById.get(m.id) || {};
                const v = p.can_view ? 'checked' : '';
                const c = p.can_create ? 'checked' : '';
                const e = p.can_edit ? 'checked' : '';
                const d = p.can_delete ? 'checked' : '';
                rows += `<tr>
                    <td>${m.category ? `<span class=\"text-secondary me-2\">[${m.category}]</span>` : ''}${m.title}</td>
                    <td class=\"text-center\"><input class=\"form-check-input menu-perm-checkbox\" type=\"checkbox\" data-menu-id=\"${m.id}\" id=\"menu_perm_${m.id}\" ${v}></td>
                    <td class=\"text-center\"><input class=\"form-check-input menu-perm-crud\" type=\"checkbox\" data-menu-id=\"${m.id}\" data-action=\"create\" id=\"menu_perm_create_${m.id}\" ${c}></td>
                    <td class=\"text-center\"><input class=\"form-check-input menu-perm-crud\" type=\"checkbox\" data-menu-id=\"${m.id}\" data-action=\"edit\" id=\"menu_perm_edit_${m.id}\" ${e}></td>
                    <td class=\"text-center\"><input class=\"form-check-input menu-perm-crud\" type=\"checkbox\" data-menu-id=\"${m.id}\" data-action=\"delete\" id=\"menu_perm_delete_${m.id}\" ${d}></td>
                </tr>`;
            });
            containerBody.innerHTML = rows || `<tr><td colspan="5" class="text-muted small">Men√º bulunamadƒ±</td></tr>`;

            // CRUD -> view enforce
            document.querySelectorAll('.menu-perm-crud').forEach(cb => {
                cb.addEventListener('change', (e) => {
                    const id = e.target.getAttribute('data-menu-id');
                    const viewBox = document.getElementById(`menu_perm_${id}`);
                    if (e.target.checked && viewBox && !viewBox.checked) viewBox.checked = true;
                });
            });

            // View kapatƒ±lƒ±nca ilgili CRUD'larƒ± temizle
            document.querySelectorAll('.menu-perm-checkbox').forEach(vb => {
                vb.addEventListener('change', (e) => {
                    const id = e.target.getAttribute('data-menu-id');
                    if (!e.target.checked) {
                        ['create','edit','delete'].forEach(act => {
                            const cb = document.getElementById(`menu_perm_${act}_${id}`);
                            if (cb) cb.checked = false;
                        });
                    }
                });
            });
        }

        async function loadRoleMenuPermissions(roleId) {
            try {
                const [menusRes, permsRes] = await Promise.all([
                    fetch('/api/menus'),
                    fetch(`/api/roles/${roleId}/menus`)
                ]);
                const menusData = await menusRes.json();
                const permsData = await permsRes.json();
                if (menusData.success) {
                    const perms = permsData.success ? permsData.data.menuPermissions : [];
                    renderMenuPermissions(menusData.data.menus, perms);
                }
            } catch (e) {
                console.error('Rol men√º yetkileri y√ºklenemedi', e);
            }
        }

        function collectMenuPermissionsFromUI() {
            const viewBoxes = document.querySelectorAll('.menu-perm-checkbox');
            const menuPermissions = [];
            viewBoxes.forEach(vb => {
                const id = parseInt(vb.getAttribute('data-menu-id'));
                const can_view = vb.checked;
                const can_create = document.getElementById(`menu_perm_create_${id}`)?.checked || false;
                const can_edit = document.getElementById(`menu_perm_edit_${id}`)?.checked || false;
                const can_delete = document.getElementById(`menu_perm_delete_${id}`)?.checked || false;
                menuPermissions.push({ menu_id: id, can_view, can_create, can_edit, can_delete });
            });
            return menuPermissions;
        }

        function syncMenuAndModulePermissions() {
            const mapping = [
                { moduleKey: 'users',    moduleViewId: 'users_view',    menuTitles: ['Kullanƒ±cƒ± Y√∂netimi'] },
                { moduleKey: 'roles',    moduleViewId: 'roles_view',    menuTitles: ['Rol Y√∂netimi'] },
                { moduleKey: 'menus',    moduleViewId: 'menus_view',    menuTitles: ['Men√º Y√∂netimi'] },
                { moduleKey: 'panel',    moduleViewId: 'panel_view',    menuTitles: ['Panel Ayarlarƒ±'] },
                { moduleKey: 'dashboard',moduleViewId: 'dashboard_view',menuTitles: ['Dashboard'] }
            ];

            // Mod√ºl ‚Üí Men√º: mod√ºl g√∂r√ºnt√ºleme i≈üaretlenince ilgili men√ºler de i≈üaretlensin
            mapping.forEach(map => {
                const modBox = document.getElementById(map.moduleViewId);
                if (!modBox) return;
                const affectByView = () => {
                    const boxes = document.querySelectorAll('.menu-perm-checkbox');
                    boxes.forEach(b => {
                        const label = document.querySelector(`label[for="${b.id}"]`);
                        if (label && map.menuTitles.includes(label.textContent.trim())) {
                            b.checked = modBox.checked;
                        }
                    });
                    // Eƒüer g√∂r√ºnt√ºleme kaldƒ±rƒ±ldƒ±ysa aynƒ± mod√ºl√ºn create/edit/delete yetkilerini de kaldƒ±r
                    if (map.moduleKey !== 'dashboard') {
                        const c = document.getElementById(`${map.moduleKey}_create`);
                        const e = document.getElementById(`${map.moduleKey}_edit`);
                        const d = document.getElementById(`${map.moduleKey}_delete`);
                        const dependent = [c,e,d].filter(Boolean);
                        if (!modBox.checked) {
                            dependent.forEach(x => { x.checked = false; x.disabled = true; });
                        } else {
                            dependent.forEach(x => { x.disabled = false; });
                        }
                    }
                };
                // ƒ∞lk durum i√ßin uygula
                affectByView();
                // Deƒüi≈üikliklerde uygula
                modBox.addEventListener('change', () => {
                    affectByView();
                    recomputePermissionDependencies();
                });
            });

            // Men√º ‚Üí Mod√ºl: bir men√º i≈üaretlenince ilgili mod√ºl g√∂r√ºnt√ºleme otomatik a√ßƒ±lsƒ±n
            const menuBoxes = document.querySelectorAll('.menu-perm-checkbox');
            menuBoxes.forEach(b => {
                b.addEventListener('change', () => {
                    const label = document.querySelector(`label[for="${b.id}"]`);
                    if (!label) return;
                    const title = label.textContent.trim();
                    mapping.forEach(map => {
                        if (!map.menuTitles.includes(title)) return;
                        const modBox = document.getElementById(map.moduleViewId);
                        if (!modBox) return;
                        if (b.checked) {
                            if (!modBox.checked) modBox.checked = true;
                        } else {
                            // Eƒüer bu mod√ºle ait hi√ßbir men√º se√ßili deƒüilse mod√ºl g√∂r√ºnt√ºlemeyi de kaldƒ±r
                            const related = Array.from(document.querySelectorAll('.menu-perm-checkbox')).filter(x => {
                                const l = document.querySelector(`label[for="${x.id}"]`);
                                return l && map.menuTitles.includes(l.textContent.trim());
                            });
                            const anyChecked = related.some(x => x.checked);
                            if (!anyChecked) modBox.checked = false;
                        }
                    });
                    recomputePermissionDependencies();
                });
            });

            // Mod√ºl create/edit/delete ‚Üí view: alt haklar i≈üaretlenince view otomatik a√ßƒ±lsƒ±n
            ['users','roles','menus','panel'].forEach(key => {
                ['create','edit','delete'].forEach(action => {
                    const cb = document.getElementById(`${key}_${action}`);
                    if (!cb) return;
                    cb.addEventListener('change', () => {
                        const view = document.getElementById(`${key}_view`);
                        if (!view) return;
                        if (cb.checked && !view.checked) {
                            view.checked = true;
                            // View a√ßƒ±ldƒ±ƒüƒ±nda baƒüƒ±mlƒ±lƒ±klarƒ± da kaldƒ±r
                            const evt = new Event('change');
                            view.dispatchEvent(evt);
                        }
                        recomputePermissionDependencies();
                    });
                });
            });
        }

        // T√ºm baƒüƒ±mlƒ±lƒ±klarƒ± tek yerden uygula (idempotent)
        function recomputePermissionDependencies() {
            const modules = (window.CURRENT_MODULES && window.CURRENT_MODULES.length)
                ? window.CURRENT_MODULES.map(m => ({
                    key: m.key,
                    view: `${m.key}_view`,
                    create: m.limited ? null : `${m.key}_create`,
                    edit: m.limited ? null : `${m.key}_edit`,
                    del: m.limited ? null : `${m.key}_delete`,
                    titles: m.menuTitles || [m.label]
                }))
                : [
                    { key: 'users', view: 'users_view', create: 'users_create', edit: 'users_edit', del: 'users_delete', titles: ['Kullanƒ±cƒ± Y√∂netimi'] },
                    { key: 'roles', view: 'roles_view', create: 'roles_create', edit: 'roles_edit', del: 'roles_delete', titles: ['Rol Y√∂netimi'] },
                    { key: 'menus', view: 'menus_view', create: 'menus_create', edit: 'menus_edit', del: 'menus_delete', titles: ['Men√º Y√∂netimi'] },
                    { key: 'dashboard', view: 'dashboard_view', titles: ['Dashboard'] }
                ];

            const allMenuBoxes = Array.from(document.querySelectorAll('.menu-perm-checkbox'));
            const titleOf = (box) => {
                const label = document.querySelector(`label[for="${box.id}"]`);
                return label ? label.textContent.trim() : '';
            };

            modules.forEach(m => {
                const view = document.getElementById(m.view);
                const create = m.create ? document.getElementById(m.create) : null;
                const edit = m.edit ? document.getElementById(m.edit) : null;
                const del = m.del ? document.getElementById(m.del) : null;

                const relatedMenus = allMenuBoxes.filter(x => m.titles.includes(titleOf(x)));
                const anyMenuChecked = relatedMenus.some(x => x.checked);

                if (view && !view.checked) {
                    [create, edit, del].forEach(x => { if (x) { x.checked = false; x.disabled = true; } });
                    relatedMenus.forEach(x => { x.checked = false; });
                } else {
                    [create, edit, del].forEach(x => { if (x) { x.disabled = false; } });
                }

                if (anyMenuChecked && view && !view.checked) {
                    view.checked = true;
                }
            });
        }

        function renderModuleGridFromMenus(allMenus) {
            const body = document.getElementById('modulePermsBody');
            if (!body) return;
            const PRESENT_TITLES = new Set(allMenus.filter(m => !m.is_category).map(m => m.title));
            window.CURRENT_MODULES = [
                { key: 'users', label: 'Kullanƒ±cƒ± Y√∂netimi', menuTitles: ['Kullanƒ±cƒ± Y√∂netimi'] },
                { key: 'roles', label: 'Rol Y√∂netimi', menuTitles: ['Rol Y√∂netimi'] },
                { key: 'menus', label: 'Men√º Y√∂netimi', menuTitles: ['Men√º Y√∂netimi'] },
                { key: 'dashboard', label: 'Dashboard', menuTitles: ['Dashboard'], limited: true }
            ].filter(m => m.menuTitles.some(t => PRESENT_TITLES.has(t)));

            let html = '';
            window.CURRENT_MODULES.forEach(m => {
                const isLimited = !!m.limited;
                html += `<tr>
                    <td class="fw-semibold">${m.label}</td>
                    <td class="text-center"><input class="form-check-input" type="checkbox" id="${m.key}_view"></td>
                    <td class="text-center">${isLimited ? '‚Äî' : `<input class=\"form-check-input\" type=\"checkbox\" id=\"${m.key}_create\">`}</td>
                    <td class="text-center">${isLimited ? '‚Äî' : `<input class=\"form-check-input\" type=\"checkbox\" id=\"${m.key}_edit\">`}</td>
                    <td class="text-center">${isLimited ? '‚Äî' : `<input class=\"form-check-input\" type=\"checkbox\" id=\"${m.key}_delete\">`}</td>
                </tr>`;
            });
            body.innerHTML = html;
        }

         async function saveRole() {
             const saveBtn = document.getElementById('saveRoleBtn');
             const spinner = saveBtn.querySelector('.spinner-border');
             
             saveBtn.disabled = true;
             spinner.classList.remove('d-none');
             
             try {
                 // Yetkileri topla
                 const permissions = {
                     // Men√º bazlƒ± ayrƒ±ntƒ±lƒ± izinler (g√∂r√ºn√ºrl√ºk + CRUD)
                     menus_actions: collectMenuPermissionsFromUI()
                 };
                 
                 const roleData = {
                     name: document.getElementById('roleName').value,
                     description: document.getElementById('roleDescription').value,
                     permissions: permissions
                 };
                 
                 const url = currentRoleId ? `/api/roles/${currentRoleId}` : '/api/roles';
                 const method = currentRoleId ? 'PUT' : 'POST';
                 
                const response = await fetch(url, {
                     method: method,
                     headers: {
                         'Content-Type': 'application/json',
                     },
                     body: JSON.stringify(roleData)
                 });
                 
                 const data = await response.json();
                 
                 if (data.success) {
                    // Men√º izinlerini de kaydet
                    try {
                        const roleIdForMenus = currentRoleId || data.data.role.id;
                        const menuPermissions = collectMenuPermissionsFromUI();
                        await fetch(`/api/roles/${roleIdForMenus}/menus`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ menuPermissions })
                        });
                    } catch (e) {
                        console.error('Men√º izinleri kaydedilemedi', e);
                    }
                     bootstrap.Modal.getInstance(document.getElementById('roleModal')).hide();
                     loadRolesContent();
                    // Sidebar men√ºlerini g√ºncelle ve cache temizle
                    if (typeof clearMenuCache === 'function') clearMenuCache();
                    if (typeof loadMenus === 'function') loadMenus();
                     showAlert('success', data.message);
                 } else {
                     showAlert('danger', data.message);
                 }
             } catch (error) {
                 console.error('Save role error:', error);
                 showAlert('danger', 'Sunucu hatasƒ±. L√ºtfen tekrar deneyin.');
             } finally {
                 saveBtn.disabled = false;
                 spinner.classList.add('d-none');
             }
         }

         async function editRole(roleId) {
             showRoleModal(roleId);
         }

         async function deleteRole(roleId) {
             showDeleteConfirmation('Bu rol√º silmek istediƒüinizden emin misiniz?', async () => {
                 try {
                     const response = await fetch(`/api/roles/${roleId}`, {
                         method: 'DELETE'
                     });
                     
                     const data = await response.json();
                     
                     if (data.success) {
                         loadRolesContent();
                         showAlert('success', data.message);
                     } else {
                         showAlert('danger', data.message);
                     }
                 } catch (error) {
                     console.error('Delete role error:', error);
                     showAlert('danger', 'Sunucu hatasƒ±. L√ºtfen tekrar deneyin.');
                 }
             });
         }

         // ========== MEN√ú Y√ñNETƒ∞Mƒ∞ FONKSƒ∞YONLARI ==========
         
         async function loadAllMenus() {
             try {
                 const response = await fetch('/api/menus');
                 const data = await response.json();
                 
                 if (data.success) {
                     menus = data.data.menus;
                     updateParentMenuSelect();
                     updateCategorySelect();
                 }
             } catch (error) {
                 console.error('All menus load error:', error);
             }
         }

         function updateParentMenuSelect() {
             const select = document.getElementById('menuParent');
             if (select) {
                 select.innerHTML = '<option value="">Ana Men√º</option>';
                 
                 menus.forEach(menu => {
                     if (!menu.parent_id) {
                         const option = document.createElement('option');
                         option.value = menu.id;
                         option.textContent = menu.title;
                         select.appendChild(option);
                     }
                 });
             }
         }

         function updateCategorySelect() {
             const select = document.getElementById('menuCategory');
             if (select) {
                 select.innerHTML = '<option value="">Kategori Se√ßin</option>';
                 
                 // Kategorileri al
                 const categories = menus.filter(menu => menu.is_category);
                 categories.forEach(category => {
                     const option = document.createElement('option');
                     option.value = category.category;
                     option.textContent = category.title;
                     select.appendChild(option);
                 });
             }
         }

         function showMenuModal(menuId = null) {
             currentMenuId = menuId;
             const modal = new bootstrap.Modal(document.getElementById('menuModal'));
             const modalTitle = document.getElementById('menuModalLabel');
             
             if (menuId) {
                 modalTitle.textContent = 'Men√º D√ºzenle';
                 loadMenuForEdit(menuId);
             } else {
                 modalTitle.textContent = 'Yeni Men√º';
                 document.getElementById('menuForm').reset();
                 document.getElementById('menuActive').checked = true;
                 // Yeni men√º i√ßin sƒ±ra numarasƒ±nƒ± otomatik ayarla
                 const maxOrder = Math.max(...menus.map(m => m.order_index), 0);
                 document.getElementById('menuOrder').value = maxOrder + 1;
                 // Kategori dropdown'unu g√ºncelle (sadece yeni men√º i√ßin)
                 updateMenuCategorySelect();
             }
             
             modal.show();
         }

         function reloadAfterSuccess() {
             // Allow toast to be visible, then hard refresh to ensure full consistency
             setTimeout(() => {
                 window.location.reload();
             }, 400);
         }

         async function loadMenuForEdit(menuId) {
             try {
                 const response = await fetch(`/api/menus/${menuId}`);
                 const data = await response.json();
                 
                 if (data.success) {
                     const menu = data.data.menu;
                     
                     // √ñnce kategori dropdown'unu g√ºncelle
                     updateMenuCategorySelect();
                     
                     // Sonra form alanlarƒ±nƒ± doldur
                     document.getElementById('menuTitle').value = menu.title;
                     document.getElementById('menuUrl').value = menu.url;
                     document.getElementById('menuIcon').value = menu.icon || '';
                     document.getElementById('menuOrder').value = menu.order_index;
                     document.getElementById('menuCategory').value = menu.category || '';
                     
                     // Aktif durumu i√ßin checkbox kontrol et
                     const activeCheckbox = document.getElementById('menuActive');
                     if (activeCheckbox) {
                         activeCheckbox.checked = menu.is_active;
                     }
                 }
             } catch (error) {
                 console.error('Menu load error:', error);
                 showAlert('danger', 'Men√º y√ºklenirken hata olu≈ütu');
             }
         }

         function updateMenuCategorySelect() {
             const select = document.getElementById('menuCategory');
             if (!select) return;
             
             select.innerHTML = '<option value="">Kategori Se√ßin</option>';
             
             // Kategorileri al
             if (menus && Array.isArray(menus)) {
                 const categories = menus.filter(menu => menu.is_category);
                 categories.forEach(category => {
                     const option = document.createElement('option');
                     option.value = category.category || category.title;
                     option.textContent = category.title;
                     select.appendChild(option);
                 });
             }
         }

         async function saveMenu() {
             const saveBtn = document.getElementById('saveMenuBtn');
             const spinner = saveBtn.querySelector('.spinner-border');
             
             saveBtn.disabled = true;
             spinner.classList.remove('d-none');
             
             try {
                 const menuData = {
                     title: document.getElementById('menuTitle').value,
                     url: document.getElementById('menuUrl').value,
                     icon: document.getElementById('menuIcon').value,
                     order_index: parseInt(document.getElementById('menuOrder').value),
                     category: document.getElementById('menuCategory').value || null,
                     is_category: false,
                     is_active: document.getElementById('menuActive').checked
                 };
                 
                 const url = currentMenuId ? `/api/menus/${currentMenuId}` : '/api/menus';
                 const method = currentMenuId ? 'PUT' : 'POST';
                 
                 const response = await fetch(url, {
                     method: method,
                     headers: {
                         'Content-Type': 'application/json',
                     },
                     body: JSON.stringify(menuData)
                 });
                 
                 const data = await response.json();
                 
                if (data.success) {
                     bootstrap.Modal.getInstance(document.getElementById('menuModal')).hide();
                     loadMenusContent();
                     // Sidebar men√ºlerini g√ºncelle
                     if (typeof loadMenus === 'function') {
                         loadMenus();
                     }
                     // Cache'i temizle
                     if (typeof clearMenuCache === 'function') {
                         clearMenuCache();
                     }
                     showAlert('success', data.message);
                    reloadAfterSuccess();
                 } else {
                     showAlert('danger', data.message);
                 }
             } catch (error) {
                 console.error('Save menu error:', error);
                 showAlert('danger', 'Sunucu hatasƒ±. L√ºtfen tekrar deneyin.');
             } finally {
                 saveBtn.disabled = false;
                 spinner.classList.add('d-none');
             }
         }

        async function editMenu(menuId) {
            showMenuModal(menuId);
        }

        async function editCategory(categoryId) {
            showCategoryModal(categoryId);
        }

         async function deleteMenu(menuId) {
             showDeleteConfirmation('Bu men√ºy√º silmek istediƒüinizden emin misiniz?', async () => {
                 try {
                     const response = await fetch(`/api/menus/${menuId}`, {
                         method: 'DELETE'
                     });
                     
                     const data = await response.json();
                     
                    if (data.success) {
                         loadMenusContent();
                         // Sidebar men√ºlerini g√ºncelle
                         if (typeof loadMenus === 'function') {
                             loadMenus();
                         }
                         // Cache'i temizle
                         if (typeof clearMenuCache === 'function') {
                             clearMenuCache();
                         }
                         showAlert('success', data.message);
                        reloadAfterSuccess();
                     } else {
                         showAlert('danger', data.message);
                     }
                 } catch (error) {
                     console.error('Delete menu error:', error);
                     showAlert('danger', 'Sunucu hatasƒ±. L√ºtfen tekrar deneyin.');
                 }
             });
         }

         async function deleteCategory(categoryId) {
             showDeleteConfirmation('Bu kategoriyi silmek istediƒüinizden emin misiniz?', async () => {
                 try {
                     const response = await fetch(`/api/menus/${categoryId}`, {
                         method: 'DELETE'
                     });
                     
                     const data = await response.json();
                     
                    if (data.success) {
                         loadMenusContent();
                         // Sidebar men√ºlerini g√ºncelle
                         if (typeof loadMenus === 'function') {
                             loadMenus();
                         }
                         // Cache'i temizle
                         if (typeof clearMenuCache === 'function') {
                             clearMenuCache();
                         }
                         showAlert('success', data.message);
                        reloadAfterSuccess();
                     } else {
                         showAlert('danger', data.message);
                     }
                 } catch (error) {
                     console.error('Delete category error:', error);
                     showAlert('danger', 'Sunucu hatasƒ±. L√ºtfen tekrar deneyin.');
                 }
             });
         }

         // ========== KATEGORƒ∞ Y√ñNETƒ∞Mƒ∞ FONKSƒ∞YONLARI ==========
         
         function showCategoryModal(categoryId = null) {
             currentCategoryId = categoryId;
             const modal = new bootstrap.Modal(document.getElementById('categoryModal'));
             const modalTitle = document.getElementById('categoryModalLabel');
             
             if (categoryId) {
                 modalTitle.textContent = 'Kategori D√ºzenle';
                 loadCategoryForEdit(categoryId);
             } else {
                 modalTitle.textContent = 'Yeni Kategori';
                 document.getElementById('categoryForm').reset();
                 // Yeni kategori i√ßin sƒ±ra numarasƒ±nƒ± otomatik ayarla
                 const maxOrder = Math.max(...menus.filter(m => m.is_category).map(m => m.order_index), 0);
                 document.getElementById('categoryOrder').value = maxOrder + 1;
             }
             
             modal.show();
         }

         async function loadCategoryForEdit(categoryId) {
             try {
                 const response = await fetch(`/api/menus/${categoryId}`);
                 const data = await response.json();
                 
                 if (data.success) {
                     const category = data.data.menu || data.data;
                     document.getElementById('categoryTitle').value = category.title;
                     document.getElementById('categoryOrder').value = category.order_index;
                 }
             } catch (error) {
                 console.error('Kategori y√ºkleme hatasƒ±:', error);
                 showAlert('danger', 'Kategori y√ºklenirken hata olu≈ütu');
             }
         }

         async function saveCategory() {
             const saveBtn = document.getElementById('saveCategoryBtn');
             const spinner = saveBtn.querySelector('.spinner-border');
             
             spinner.classList.remove('d-none');
             saveBtn.disabled = true;
             
             try {
                 const categoryData = {
                     title: document.getElementById('categoryTitle').value,
                     order_index: parseInt(document.getElementById('categoryOrder').value),
                     is_category: true,
                     category: document.getElementById('categoryTitle').value
                 };
                 
                 const url = currentCategoryId ? `/api/menus/${currentCategoryId}` : '/api/menus';
                 const method = currentCategoryId ? 'PUT' : 'POST';
                 
                 const response = await fetch(url, {
                     method: method,
                     headers: {
                         'Content-Type': 'application/json'
                     },
                     body: JSON.stringify(categoryData)
                 });
                 
                 const data = await response.json();
                 
                if (data.success) {
                     bootstrap.Modal.getInstance(document.getElementById('categoryModal')).hide();
                     loadMenusContent();
                     // Sidebar men√ºlerini g√ºncelle
                     if (typeof loadMenus === 'function') {
                         loadMenus();
                     }
                     // Cache'i temizle
                     if (typeof clearMenuCache === 'function') {
                         clearMenuCache();
                     }
                     showAlert('success', data.message);
                    reloadAfterSuccess();
                 } else {
                     showAlert('danger', data.message);
                 }
             } catch (error) {
                 console.error('Kategori kaydetme hatasƒ±:', error);
                 showAlert('danger', 'Kategori kaydedilirken hata olu≈ütu');
             } finally {
                 saveBtn.disabled = false;
                 spinner.classList.add('d-none');
             }
         }

         // ========== YARDIMCI FONKSƒ∞YONLAR ==========
         
         function showDeleteConfirmation(message, callback) {
             // Modal HTML'i olu≈ütur
             const modalHtml = `
                 <div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-labelledby="deleteConfirmModalLabel" aria-hidden="true">
                     <div class="modal-dialog modal-dialog-centered">
                         <div class="modal-content">
                             <div class="modal-header border-0 pb-0">
                                 <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                             </div>
                             <div class="modal-body text-center py-4">
                                 <div class="mb-4">
                                     <div class="avatar-lg mx-auto mb-4">
                                         <div class="avatar-title bg-danger-subtle text-danger rounded-circle fs-20">
                                             <i class="ri-delete-bin-6-line"></i>
                                         </div>
                                     </div>
                                     <h5 class="mb-2">Silme Onayƒ±</h5>
                                     <p class="text-muted mb-4">${message}</p>
                                 </div>
                                 <div class="d-flex gap-2 justify-content-center">
                                     <button type="button" class="btn btn-light" data-bs-dismiss="modal">
                                         <i class="ri-close-line me-1"></i> ƒ∞ptal
                                     </button>
                                     <button type="button" class="btn btn-danger" id="confirmDeleteBtn">
                                         <i class="ri-delete-bin-6-line me-1"></i> Evet, Sil
                                     </button>
                                 </div>
                             </div>
                         </div>
                     </div>
                 </div>
             `;
             
             // Eski modal'ƒ± kaldƒ±r
             const existingModal = document.getElementById('deleteConfirmModal');
             if (existingModal) {
                 existingModal.remove();
             }
             
             // Yeni modal'ƒ± ekle
             document.body.insertAdjacentHTML('beforeend', modalHtml);
             
             // Modal'ƒ± g√∂ster
             const modal = new bootstrap.Modal(document.getElementById('deleteConfirmModal'));
             modal.show();
             
             // Silme butonuna event listener ekle
             document.getElementById('confirmDeleteBtn').addEventListener('click', async () => {
                 modal.hide();
                 await callback();
             });
             
             // Modal kapandƒ±ƒüƒ±nda DOM'dan kaldƒ±r
             document.getElementById('deleteConfirmModal').addEventListener('hidden.bs.modal', function () {
                 this.remove();
             });
         }

         function showAlert(type, message) {
             // Mevcut alert'leri temizle
             const existingAlerts = document.querySelectorAll('.alert');
             existingAlerts.forEach(alert => alert.remove());
             
             const alertDiv = document.createElement('div');
             alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
             alertDiv.style.position = 'fixed';
             alertDiv.style.bottom = '20px';
             alertDiv.style.right = '20px';
             alertDiv.style.zIndex = '9999';
             alertDiv.style.minWidth = '300px';
             alertDiv.style.maxWidth = '400px';
             alertDiv.style.boxShadow = '0 4px 12px rgba(0,0,0,0.15)';
             alertDiv.style.borderRadius = '8px';
             alertDiv.innerHTML = `
                 <div class="d-flex align-items-center">
                     <div class="flex-grow-1">
                         <strong>${type === 'success' ? 'Ba≈üarƒ±lƒ±!' : type === 'danger' ? 'Hata!' : 'Bilgi!'}</strong><br>
                         <small>${message}</small>
                     </div>
                     <button type="button" class="btn-close ms-2" data-bs-dismiss="alert" aria-label="Close"></button>
                 </div>
             `;
             
             // Body'ye direkt ekle
             document.body.appendChild(alertDiv);
             
             // 5 saniye sonra kaldƒ±r
             setTimeout(() => {
                 if (alertDiv.parentNode) {
                     alertDiv.remove();
                 }
             }, 5000);
         }

         // Sayfa y√ºklendiƒüinde rolleri y√ºkle - common.js'de zaten yapƒ±lƒ±yor
         // DOMContentLoaded event listener kaldƒ±rƒ±ldƒ± (√ßift √ßaƒürƒ± √∂nlendi)
    </script>
</body>
</html>
