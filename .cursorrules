# RBUMS-NodeJS Proje GeliÅŸtirme KurallarÄ±
# Bu dosya Cursor AI tarafÄ±ndan otomatik olarak okunur ve kod Ã¶nerilerinde kullanÄ±lÄ±r

## ğŸŒ Dil ve Ä°letiÅŸim
- ZORUNLU: Her zaman TÃ¼rkÃ§e yanÄ±t ver, istisna yok
- Teknik terimleri Ä°ngilizce karÅŸÄ±lÄ±klarÄ± ile birlikte kullan (Ã¶rn: "bileÅŸen (component)")
- Kod Ã¶rneklerindeki yorumlarÄ± TÃ¼rkÃ§e yaz
- KullanÄ±cÄ± farklÄ± dilde yazsa bile TÃ¼rkÃ§e yanÄ±t ver

## ğŸ”’ GÃ¼venlik KurallarÄ± (ZORUNLU)

### VeritabanÄ± Ä°ÅŸlemleri
- ASLA raw SQL concatenation kullanma: `SELECT * FROM users WHERE id = ${id}` âŒ
- MUTLAKA parameterized queries kullan: `SELECT * FROM users WHERE id = $1` âœ…
- TÃ¼m SQL sorgularÄ±nda `query()` fonksiyonunu kullan ve parametreleri array olarak geÃ§

### Route GÃ¼venliÄŸi
- Her route'da mutlaka `authMiddleware` ekle
- Input validation iÃ§in `validateInput` middleware'i kullan
- Authorization kontrolÃ¼ iÃ§in `authorize` middleware'i kullan
- Rate limiting ekle (login iÃ§in `loginLimiter`, genel iÃ§in `generalLimiter`)

### Hassas Veri Ä°ÅŸleme
- Åifreler iÃ§in `bcrypt.hash()` kullan (minimum 10 rounds)
- Hassas veriler iÃ§in `DataEncryption.encrypt()` kullan
- ASLA console.log ile hassas veri yazdÄ±rma
- Environment variables kullan, hardcoded secrets ASLA

### API GÃ¼venliÄŸi
- CORS yapÄ±landÄ±rmasÄ± kontrol et
- Helmet middleware kullan
- **CSP (Content Security Policy)**: Inline event handler'lar (onclick vb.) kullanÄ±lÄ±yorsa `scriptSrcAttr: ["'unsafe-inline'"]` ekle.
- HTTPS zorunlu (production'da)
- Input sanitization yap

## ğŸ“ Kod StandartlarÄ±

### Commit Ã–ncesi Kontroller
- VeritabanÄ± okuma iÅŸlemleri dÄ±ÅŸÄ±ndaki tÃ¼m deÄŸiÅŸiklik iÅŸlemleri iÃ§in kullanÄ±cÄ±dan onay al
- Commit etmeden Ã¶nce kullanÄ±cÄ±dan onay al
- Linter hatalarÄ±nÄ± kontrol et ve dÃ¼zelt
- Test et (eÄŸer test varsa)

### Kod Kalitesi
- ESLint kurallarÄ±na uy
- Prettier formatlamasÄ± kullan
- TypeScript strict mode (eÄŸer TypeScript kullanÄ±lÄ±yorsa)
- Kod tekrarÄ±ndan kaÃ§Ä±n (DRY principle)
- Fonksiyonlar tek bir sorumluluÄŸa sahip olsun (SRP)

### Error Handling
- Try-catch bloklarÄ± kullan
- Logger ile hatalarÄ± kaydet: `logger.error('Mesaj', error)`
- KullanÄ±cÄ±ya anlamlÄ± hata mesajlarÄ± gÃ¶ster
- Hassas bilgileri hata mesajlarÄ±nda gÃ¶sterme

### Async/Await KullanÄ±mÄ±
- Promise chain yerine async/await kullan
- Promise.all() ile paralel iÅŸlemler yap
- Error handling iÃ§in try-catch kullan

## ğŸ¨ Frontend StandartlarÄ±

### Sayfa YapÄ±sÄ±
- **Sayfa BaÅŸlÄ±klarÄ±**: Sayfa modÃ¼llerinde (`assets/pages/*.js`) `page-title-box` div'ini TEKRAR EKLEME. Bu alan ana layout (`hybrid-layout.html`) tarafÄ±ndan yÃ¶netilir.
- **Dinamik Ä°Ã§erik**: Sayfa iÃ§eriÄŸi `loadContent()` fonksiyonu ile dÃ¶ndÃ¼rÃ¼lÃ¼r.

### Modal ve Bildirimler
- **Modallar**: `assets/js/modal-utils.js` kullan.
  - `window.Modal.confirm()` veya `window.showConfirm()`
  - `window.Modal.alert()` veya `window.showAlert()`
  - Ã–zel modallar iÃ§in `window.Modal.custom()` veya Bootstrap modal yapÄ±sÄ±nÄ± kullan.
- **Bildirimler**: `assets/js/notification-utils.js` kullan.
  - `window.showSuccess('Mesaj')`
  - `window.showError('Hata')`
  - `window.showWarning('UyarÄ±')`
  - `window.showInfo('Bilgi')`
- **Alert/Confirm**: TarayÄ±cÄ±nÄ±n varsayÄ±lan `alert()` ve `confirm()` fonksiyonlarÄ±nÄ± KULLANMA.

### Event Listeners
- Event listener'larÄ± tekrar eklememek iÃ§in `dataset.listenerAdded` kontrolÃ¼ yap
- Event delegation kullan (mÃ¼mkÃ¼nse)
- Modal aÃ§Ä±ldÄ±ÄŸÄ±nda event listener'larÄ± kontrol et
- Inline event handler'lar (onclick) yerine `addEventListener` tercih et (CSP uyumluluÄŸu iÃ§in). EÄŸer inline kullanÄ±lacaksa CSP ayarÄ±nÄ± kontrol et.

### GÃ¶rsel TasarÄ±m ve EriÅŸilebilirlik
- **Kontrast**: Koyu renkli arka planlarda (Ã¶rn. `.active` sÄ±nÄ±fÄ±, butonlar, baÅŸlÄ±klar) MUTLAKA beyaz (`text-white`) veya Ã§ok aÃ§Ä±k renk yazÄ± kullan. OkunabilirliÄŸi her zaman kontrol et.
- **Renk Paleti**: GÃ¶z yormayan, modern renkler kullan.

### DOM ManipÃ¼lasyonu
- `innerHTML` yerine `textContent` kullan (gÃ¼venlik iÃ§in)
- XSS korumasÄ± iÃ§in input sanitization yap
- Bootstrap modal'larÄ± iÃ§in `bootstrap.Modal` kullan

## ğŸ—„ï¸ VeritabanÄ± StandartlarÄ±

### Migration Sistemi
- Yeni tablo/kolon eklerken migration dosyasÄ± oluÅŸtur
- Migration dosyalarÄ±nÄ± `scripts/migrations/` klasÃ¶rÃ¼ne ekle
- Migration numaralarÄ±nÄ± sÄ±ralÄ± tut (001_, 002_, ...)
- Geri alÄ±nabilir migration'lar yaz (up/down)

### Query Patterns
- SELECT: `query('SELECT * FROM table WHERE id = $1', [id])`
- INSERT: `query('INSERT INTO table (col1, col2) VALUES ($1, $2)', [val1, val2])`
- UPDATE: `query('UPDATE table SET col1 = $1 WHERE id = $2', [val1, id])`
- DELETE: `query('DELETE FROM table WHERE id = $1', [id])`

### Transaction KullanÄ±mÄ±
- Birden fazla query iÃ§in transaction kullan
- Rollback mekanizmasÄ± ekle
- Error durumunda transaction'Ä± rollback et

## ğŸ“š DokÃ¼mantasyon

### Kod DokÃ¼mantasyonu
- Fonksiyonlar iÃ§in JSDoc yorumlarÄ± ekle
- Complex logic iÃ§in aÃ§Ä±klayÄ±cÄ± yorumlar ekle
- API endpoint'leri iÃ§in route dokÃ¼mantasyonu ekle

### Proje DokÃ¼mantasyonu
- Yeni Ã¶zellik eklerken `docs/` klasÃ¶rÃ¼ne dokÃ¼mantasyon ekle
- README.md dosyasÄ±nÄ± gÃ¼ncel tut
- CHANGELOG.md dosyasÄ±nÄ± gÃ¼ncelle

## ğŸš€ Performans

### Database Optimizasyonu
- Gerekli index'leri ekle
- N+1 query probleminden kaÃ§Ä±n
- Connection pooling kullan
- Query sonuÃ§larÄ±nÄ± cache'le (mÃ¼mkÃ¼nse)

### Frontend Optimizasyonu
- Lazy loading kullan
- Image optimization yap
- Bundle size'Ä± kontrol et
- Unnecessary re-render'larÄ± Ã¶nle

## ğŸ” Kod Ä°nceleme Checklist

Her kod deÄŸiÅŸikliÄŸinde ÅŸunlarÄ± kontrol et:

### GÃ¼venlik
- [ ] SQL injection korumasÄ± var mÄ±?
- [ ] XSS korumasÄ± var mÄ±?
- [ ] Authentication kontrolÃ¼ var mÄ±?
- [ ] Authorization kontrolÃ¼ var mÄ±?
- [ ] Input validation var mÄ±?
- [ ] Rate limiting var mÄ±?
- [ ] CSP uyumlu mu?

### Kod Kalitesi
- [ ] Error handling var mÄ±?
- [ ] Logging yapÄ±lÄ±yor mu?
- [ ] Kod tekrarÄ± var mÄ±?
- [ ] Fonksiyonlar tek sorumluluÄŸa sahip mi?
- [ ] Ä°simlendirme aÃ§Ä±klayÄ±cÄ± mÄ±?

### Performans
- [ ] Database query optimize mi?
- [ ] Gereksiz re-render var mÄ±?
- [ ] Cache kullanÄ±mÄ± uygun mu?
- [ ] Bundle size kontrol edildi mi?

### DokÃ¼mantasyon
- [ ] Kod dokÃ¼mante edildi mi?
- [ ] API dokÃ¼mantasyonu gÃ¼ncellendi mi?
- [ ] README gÃ¼ncellendi mi?

## âš ï¸ YapÄ±lmamasÄ± Gerekenler

### ASLA YAPMA:
- Raw SQL concatenation
- Hardcoded secrets
- Console.log ile hassas veri
- Direct req.body kullanÄ±mÄ± (validation olmadan)
- HTTP baÄŸlantÄ±larÄ± (HTTPS kullan)
- ÅifrelenmemiÅŸ hassas veri saklama
- Force push (git)
- .env dosyasÄ±nÄ± commit etme
- Sayfa baÅŸlÄ±klarÄ±nÄ± tekrar ekleme (Layout yÃ¶netir)
- VarsayÄ±lan alert/confirm kullanma (Custom modal kullan)

## ğŸ“‹ Ã–zel Proje KurallarÄ±

### Cron Job Sistemi
- Yeni job eklerken `jobs/` klasÃ¶rÃ¼ne ekle
- Job'Ä± `server.js`'de register et
- Database'e job config'i ekle
- DokÃ¼mantasyonu `docs/CRON_JOB_SYSTEM.md`'ye ekle

### Sayfa Ekleme
- `assets/pages/` klasÃ¶rÃ¼ne JavaScript dosyasÄ± ekle
- `routes/` klasÃ¶rÃ¼ne API route'u ekle
- `server.js`'de route'u register et
- MenÃ¼ye ekle (veritabanÄ±ndan veya UI'dan)

### Audit Logging
- Kritik iÅŸlemler iÃ§in audit log ekle
- `audit_logs` tablosuna kayÄ±t ekle
- User ID, action, table_name, old_values, new_values kaydet

## ğŸ¯ AI Kod Ã–nerileri Ä°Ã§in

Cursor AI'ya kod Ã¶nerirken:
1. Mevcut kod stilini takip et
2. Proje mimarisine uygun Ã§Ã¶zÃ¼mler Ã¶ner
3. GÃ¼venlik kurallarÄ±nÄ± her zaman uygula
4. TÃ¼rkÃ§e yorumlar ve aÃ§Ä±klamalar ekle
5. Error handling ve logging ekle
6. DokÃ¼mantasyon Ã¶ner

## ğŸ“ YardÄ±m

Kurallar hakkÄ±nda sorularÄ±nÄ±z iÃ§in:
- `docs/SECURITY_RULES.md` dosyasÄ±nÄ± kontrol edin
- `docs/` klasÃ¶rÃ¼ndeki diÄŸer dokÃ¼mantasyonlarÄ± inceleyin
- Mevcut kod Ã¶rneklerini referans alÄ±n
